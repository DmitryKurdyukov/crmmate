import{C as ge}from"./CustomHeader-CMp8T63a.js";import{c8 as T,m as oe,_ as W,T as re,F as ne,bR as de,R as ue,b as D,J as X,N as J,e as d,f as c,g as a,h as g,O as E,y as x,W as $,p as he,k as ce,cz as be,r as K,Z as ke,c as Z,cF as Le,x as V,K as Q,aB as we,i as _,j as O,aa as N,t as L,az as Pe,c1 as pe,c2 as ye,d as _e,bK as Ce,bS as De,M as Fe,bU as Ae,b$ as Te,bW as Me,c9 as xe,bX as Oe,bV as Ee,a7 as Ie,cb as $e,C as G,aO as Re,H as Se,al as U,bL as ee,a1 as B,a5 as te}from"./index-4ykL4QJn.js";import{s as Ne}from"./chart.esm-Dr16xJ61.js";import{a as S}from"./A_Pivot-Dsgx5vVk.js";import{M as Be}from"./MobileModeFields-Bfnk6Q-z.js";import{D as He}from"./DynamicFilter-CS4McVAp.js";import{T as je}from"./TbTabs-DIp7bxf5.js";import{M as Ve}from"./MobileHandlerMixin-DCpB2pQs.js";import{u as Ue}from"./useTimeframe-B5vMgNlE.js";const R=["firstLevel","secondLevel","thirdLevel","fourthLevel"],se="so",qe="lg",Ke="medium",We="campaign",Ge="ad",ze="term",Ye="offer",I="brand",C="country",me="box",M="campaigns",P="affiliates",Xe="day",Je="month",z=[[I,M,P],[I,P,M],[I,C,M],[I,C,P],[I,P,C],[M,P,C],[M,C,P],[P,I,M],[P,I,C],[P,M,C],[P,C,I],[P,C,M],[C,I,M],[C,I,P],[C,M,P],[C,P,I],[C,P,M],[P,me,M]],ie=(e,t,s,i)=>{if(T.getType(e)!=="array")return e;let r=(l,o,n)=>o>=3?!1:!T.isNumpty(l[n[o+1]]);return e.map(l=>({...l,unique_id:T.uuid(),children:r(t,s,i)?null:"0",auto_login_chart_tooltip:"Auto login usage"}))},ae=(e,t,s,i,r,l)=>{let o=r;for(let n=i;n>=0;n--)o=o.depth===n?o:o.parent,t[e[s[n]]]=[o[l]];return t},Y=(e,t,s,i,r,l)=>{let o=r;for(let n=i;n>=0;n--)o=o.depth===n?o:o.parent,e.filterBy[t[s[n]]]=[o[l]],i===0&&(e.groupBy=t.secondLevel);return e},Ze=()=>({preventApi:!1,loadingChart:!1,infoAutoLogin:{ai:"",li:""},autologinModal:!1,currentDynamicLevel:se,chartData:[],allowChart:!1,chartDataAutoLogin:{aNotused:0,totalLeads:0,used:0,notUsedPercent:0,userPercent:0,aMatch:0,aNotMatch:0,usedMatchPercent:0,usedNotMatchPercent:0,totalMatchPercent:0,totalNotMatchPercent:0},chartMetadata:{totalFTD:0,totalLeads:0},includePricing:!1,loading:!1,enableNesting:!1,enableChart:!1,data:[],days:[{day:[],hours:[{from:null,to:null}],valid:!0}],dayOptions:[{id:0,name:"Sunday"},{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"}],filters:{showIdAsName:!1,dateRange:[],depth:0,page:0,limit:25,searchKey:"",searchValue:"",boxes:[],brands:[],countries:[],campaigns:[],affiliates:[],brand:[],offer:[],so:[],firstLevel:"affiliates",secondLevel:"",thirdLevel:"",fourthLevel:"",preset:"",excInjectionAI:!1,playerStats:!1},lists:{hasDynamicLevel:!1,countries:[],campaigns:[],affiliates:[],boxes:[],brands:[],columns:[],currency:{},rev_stats:null,presets:[{id:0,name:"Brand -> Campaign -> Affiliate"},{id:1,name:"Brand -> Affiliate -> Campaign"},{id:2,name:"Brand -> Country -> Campaign"},{id:3,name:"Brand -> Country -> Affiliate"},{id:4,name:"Brand -> Affiliate -> Country"},{id:5,name:"Campaign -> Affiliate -> Country"},{id:6,name:"Campaign -> Country -> Affiliate"},{id:7,name:"Affiliate -> Brand -> Campaign"},{id:8,name:"Affiliate -> Brand -> Country"},{id:9,name:"Affiliate -> Campaign -> Country"},{id:10,name:"Affiliate -> Country -> Brand"},{id:11,name:"Affiliate -> Country -> Campaign"},{id:12,name:"Country -> Brand -> Campaign"},{id:13,name:"Country -> Brand -> Affiliate"},{id:14,name:"Country -> Campaign -> Affiliate"},{id:15,name:"Country -> Affiliate -> Brand"},{id:16,name:"Country -> Affiliate -> Campaign"},{id:17,name:"Affiliate -> Box -> Campaign"}],levels:[{id:Xe,name:"Day"},{id:Je,name:"Month"},{id:P,name:"Affiliates"},{id:M,name:"Campaigns"},{id:I,name:"Brand"},{id:C,name:"Country"},{id:me,name:"Box"},{id:Ye,name:"Offer"},{id:se,name:"So (Media)"},{id:qe,name:"LG"},{id:Ke,name:"Medium (Media)"},{id:We,name:"Campaign (Media)"},{id:Ge,name:"Ad (Media)"},{id:ze,name:"Term (Media)"}]}}),Qe=()=>[{day:[],hours:[{from:null,to:null}],valid:!0}],et=Ze(),tt={fetchListsPayload:e=>({dateRange:e.filters.dateRange,affiliates:e.filters.affiliates,campaigns:e.filters.campaigns,countries:e.filters.countries,boxes:e.filters.boxes,brands:e.filters.brands,excInjectionAI:!e.filters.excInjectionAI}),pivotFetchPayload:e=>{let t=null;T.isNumpty(e.filters.secondLevel)||(t={filter:e.filters.firstLevel,groupBy:e.filters.secondLevel});let s=e.filters[R[e.filters.depth]];return{showIdAsName:e.filters.showIdAsName,from:e.filters.dateRange[0],to:e.filters.dateRange[1],nextLevel:t,groupBy:s,filterBy:{country:e.filters.countries.map(i=>i.id),campaigns:e.filters.campaigns.map(i=>i.id),affiliates:e.filters.affiliates.map(i=>i.id),box:e.filters.boxes.map(i=>i.id),brand:e.filters.brands.map(i=>i.id)},includePricing:e.includePricing,excInjectionAI:!e.filters.excInjectionAI,days:e.days}},exportPayload:e=>{let t=[],s=e.filters.firstLevel;for(const i of R){if(!e.filters[i])break;t.push(e.filters[i])}for(let i=R.length-1;i>=0;i--)if(!T.isEmpty(e.filters[R[i]])){s=e.filters[R[i]];break}return{showIdAsName:e.filters.showIdAsName,from:e.filters.dateRange[0],to:e.filters.dateRange[1],groupBy:s,includePricing:e.includePricing,excInjectionAI:!e.filters.excInjectionAI,levels:t,filterBy:{country:e.filters.countries.map(i=>i.id),campaigns:e.filters.campaigns.map(i=>i.id),affiliates:e.filters.affiliates.map(i=>i.id),box:e.filters.boxes.map(i=>i.id),brand:e.filters.brands.map(i=>i.id)},days:e.days}},levelsListPerLevel:e=>{let t=e.lists.levels,s=t.filter(l=>l.id!==e.filters.firstLevel),i=s.filter(l=>l.id!==e.filters.secondLevel),r=i.filter(l=>l.id!==e.filters.thirdLevel);return{firstLevel:Array.from(new Set(t)),secondLevel:Array.from(new Set(s)),thirdLevel:Array.from(new Set(i)),fourthLevel:Array.from(new Set(r))}}},st={stateUpdateDay(e,t){let s=e.state.days[t.index].hours;s.map(i=>{i.from="00",i.to="24"}),e.commit("updateIndexInArray",{array:"days",iterator:"day",iterator_value:e.state.days[t.index].day,key:"hours",value:s})},stateAddDay(e){let t=e.state.days;t.push({day:[],hours:[{from:null,to:null}],valid:!0}),e.commit("setProperty",{key:"days",value:t})},stateAddHour(e,t){let s=e.state.days[t.itemIndex].hours;s.push({from:"00",to:"24"}),e.commit("updateIndexInArray",{array:"days",iterator:"day",iterator_value:e.state.days[t.itemIndex].day,key:"hours",value:s})},stateRemoveHour(e,t){let s=e.state.days[t.itemIndex].hours;s.splice(t.hourIndex,1),e.commit("updateIndexInArray",{array:"days",iterator:"day",iterator_value:e.state.days[t.itemIndex].day,key:"hours",value:s})},stateDeleteRow(e,t){let s=e.state.days;s.splice(t.rowIndex,1),e.commit("setProperty",{key:"days",value:s})},stateClearFilters(e){return e.commit("setObject",{path:"filters.firstLevel",value:"affiliates"}),e.commit("setObject",{path:"filters.secondLevel",value:""}),e.commit("setObject",{path:"filters.thirdLevel",value:""}),e.commit("setObject",{path:"filters.fourthLevel",value:""}),e.commit("setObject",{path:"filters.dateRange",value:""}),e.commit("setObject",{path:"filters.preset",value:""}),!0},stateClearAdvancedFilters(e){return e.commit("setObject",{path:"filters.countries",value:[]}),e.commit("setObject",{path:"filters.campaigns",value:[]}),e.commit("setObject",{path:"filters.affiliates",value:[]}),e.commit("setObject",{path:"filters.countries",value:[]}),e.commit("setObject",{path:"filters.boxes",value:[]}),e.commit("setObject",{path:"filters.brands",value:[]}),e.commit("setProperty",{key:"days",value:Qe()}),!0},stateGetLists({commit:e,state:t,getters:s}){return e("setProperty",{key:"loading",value:!0}),S.getLists().then(i=>{e("setObject",{path:"lists.hasDynamicLevel",value:i.data.hasDynamicLevel}),e("setObject",{path:"autologinStatusButton",value:i.data.autologinStatusButton});let r=i.data.columns;const l=i.data.autologinStatusButton;i.data.showChart&&(r=[{key:"insights",label:"Insights",default:!0,hidden:!1},...r]),l&&(r=[{key:"auto_login_chart",label:"Auto Login Chart",hideLabel:!0,default:!0,hidden:!1},...r]),e("setObject",{path:"lists.columns",value:r}),e("setObject",{path:"lists.rev_stats",value:i.data.rev_stats}),e("setObject",{path:"enableChart",value:i.data.showChart});const o=oe(),n=o.getFilteredList("campaigns",{by:"active",value:["1","2","3"]});return e("setObject",{path:"lists.campaigns",value:n}),e("setObject",{path:"lists.countries",value:o.lists.value.countries}),e("setObject",{path:"lists.boxes",value:o.lists.value.boxes}),e("setObject",{path:"lists.brands",value:o.lists.value.brands}),e("setObject",{path:"lists.offers",value:o.lists.value.offers}),e("setObject",{path:"lists.currency",value:o.lists.value.currency}),e("setObject",{path:"lists.currencies",value:o.lists.value.currencies}),e("setObject",{path:"lists.affiliates",value:o.lists.value.affiliates}),e("setProperty",{key:"loading",value:!1}),i}).catch(i=>{throw e("setProperty",{key:"loading",value:!1}),i})},stateFetchCampaignsByAffiliate({getters:e,commit:t}){return S.getLists(e.fetchListsPayload).then(s=>(t("setObject",{path:"lists.campaigns",value:s.data.campaigns}),s)).catch(s=>{throw s})},async stateFetchPivot({commit:e,state:t,getters:s}){const i=new Date(s.pivotFetchPayload.to),r=new Date(s.pivotFetchPayload.from);if(T.getDateDifferenceIn(r,i,"days")>365)throw{msg:"Data retrieval is limited to a maximum period of one year. Please adjust the date range accordingly."};return e("setProperty",{key:"loading",value:!0}),e("setProperty",{nested:"filters",key:"depth",value:0}),S.pivotFetch(s.pivotFetchPayload).then(o=>{if(o.status!==200)throw"error";return e("setProperty",{key:"data",value:ie(o.data,t.filters,t.filters.depth,R)}),e("setProperty",{key:"enableNesting",value:!T.isNumpty(t.filters.secondLevel)}),o.data[0]&&Object.keys(o.data[0]).forEach(n=>{(n.toString()==="unqualified_ftds"||n.toString()==="unqualified_leads")&&e("setProperty",{nested:"filters",key:"playerStats",value:!0})}),e("setProperty",{key:"loading",value:!1}),o}).catch(o=>{throw e("setProperty",{key:"loading",value:!1}),o})},async stateFetchPivotNestedData({commit:e,state:t,getters:s,dispatch:i},{currentDepth:r,item:l}){const o=new Date(s.pivotFetchPayload.to),n=new Date(s.pivotFetchPayload.from);if(T.getDateDifferenceIn(n,o,"days")>365)throw{msg:"Data retrieval is limited to a maximum period of one year. Please adjust the date range accordingly."};let y=r+1;t.filters.depth<=3?e("setProperty",{nested:"filters",key:"depth",value:y}):e("setProperty",{nested:"filters",key:"depth",value:r});let m=T.clone(s.pivotFetchPayload);return m.filterBy=ae(t.filters,m.filterBy,R,r,l,"id"),S.pivotFetch(m).then(v=>{if(v.status!==200)throw"error";return ie(v.data,t.filters,t.filters.depth,R)}).catch(v=>{throw v})},async ALFetch({state:e,commit:t,getters:s},{currentDepth:i,item:r,key:l}){let o=i+1;e.filters.depth<3?t("setProperty",{nested:"filters",key:"depth",value:o}):t("setProperty",{nested:"filters",key:"depth",value:i});let n=T.clone(s.pivotFetchPayload);return n=Y(n,e.filters,R,i,r,"id"),await S.ALFetch({...n,groupBy:"hour"}).then(p=>{window.helper.status(p);let{data:y}=p.data;for(let m in y)e.chartDataAutoLogin.hasOwnProperty(m)&&(m==="totalLeads"&&t("setProperty",{key:"allowChart",value:y.totalLeads>0}),t("setProperty",{key:m,nested:"chartDataAutoLogin",value:y[m]}));return p}).catch(p=>{throw p}).finally(()=>{t("setProperty",{key:"loading",value:!1})})},stateFetchPivotTooltipData({dispatch:e,commit:t,state:s,getters:i},{currentDepth:r,item:l,key:o}){const n=new Date(i.pivotFetchPayload.to),p=new Date(i.pivotFetchPayload.from);if(window.helper.getDateDifferenceIn(p,n,"days")>365)throw{msg:"Data retrieval is limited to a maximum period of one year. Please adjust the date range accordingly."};if(s.preventApi)return;let m=s.filters.depth,v=r+1;s.filters.depth<3?t("setProperty",{nested:"filters",key:"depth",value:v}):t("setProperty",{nested:"filters",key:"depth",value:r});let F=T.clone(i.pivotFetchPayload);F=Y(F,s.filters,R,r,l,"id");let f="";switch(o){case"leads":f="getLeadTooltip";break;case"ftds":case"real_ftds":f="getFtdsTooltip",o==="real_ftds"&&(F.real_ftds=!0);break;case"payout":f="getPayoutTooltip";break}return t("setProperty",{key:"preventApi",value:!0}),e(f,F).then(w=>(t("setProperty",{nested:"filters",key:"depth",value:m}),w.data)).catch(w=>{throw w}).finally(()=>{t("setProperty",{key:"preventApi",value:!1})})},stateClearLevels({dispatch:e,commit:t,state:s},i){const{level:r,levels:l,clear:o}=i;if(o){t("setProperty",{nested:"filters",key:"firstLevel",value:""}),t("setProperty",{nested:"filters",key:"secondLevel",value:""}),t("setProperty",{nested:"filters",key:"thirdLevel",value:""}),t("setProperty",{nested:"filters",key:"fourthLevel",value:""});return}l.forEach(n=>{if(s.filters[n]===s.filters[r])switch(t("setProperty",{nested:"filters",key:n,value:""}),n){case"secondLevel":t("setProperty",{nested:"filters",key:"thirdLevel",value:""}),t("setProperty",{nested:"filters",key:"fourthLevel",value:""});break;case"thirdLevel":t("setProperty",{nested:"filters",key:"fourthLevel",value:""});break}})},stateAllocatePreset({commit:e,state:t},s){return e("setProperty",{nested:"filters",key:"firstLevel",value:z[s][0]}),e("setProperty",{nested:"filters",key:"secondLevel",value:z[s][1]}),e("setProperty",{nested:"filters",key:"thirdLevel",value:z[s][2]}),t.filters},statePivotExport({state:e,getters:t},s){return S.exportCsv({...t.exportPayload,select:s}).then(i=>i).catch(i=>{throw i})},async statePivotHourlyFetch({state:e,getters:t,commit:s},{currentDepth:i,item:r,key:l}){const o=new Date(t.pivotFetchPayload.to),n=new Date(t.pivotFetchPayload.from);if(window.helper.getDateDifferenceIn(n,o,"days")>365)throw{msg:"Data retrieval is limited to a maximum period of one year. Please adjust the date range accordingly."};let y=i+1;e.filters.depth<3?s("setProperty",{nested:"filters",key:"depth",value:y}):s("setProperty",{nested:"filters",key:"depth",value:i});let m=T.clone(t.pivotFetchPayload);return m=Y(m,e.filters,R,i,r,"id"),await S.pivotHourlyFetch({...m,groupBy:"hour"}).then(v=>{if(v.data.status===!1&&v.data.data==="No access")return!1;if(v.data.e&&v.data.e==="dates are missing or too long")throw!1;window.helper.status(v),s("setProperty",{key:"chartData",value:window.helper.sortArrayByKey(v.data.data,"hour","desc")});const F=v.data.data.reduce((w,k)=>w+Number(k.sumLeads),0),f=v.data.data.reduce((w,k)=>w+Number(k.sumFtds),0);return s("setProperty",{key:"totalFTD",nested:"chartMetadata",value:f}),s("setProperty",{key:"totalLeads",nested:"chartMetadata",value:F}),v}).catch(v=>{throw v}).finally(()=>{s("setProperty",{key:"loading",value:!1})})},stateGetDynamicLevelData({state:e,getters:t,commit:s},i){const r=new Date(t.pivotFetchPayload.to),l=new Date(t.pivotFetchPayload.from);if(window.helper.getDateDifferenceIn(l,r,"days")>365)throw{msg:"Data retrieval is limited to a maximum period of one year. Please adjust the date range accordingly."};const n=i.item.depth,p=n+1;s("setProperty",{nested:"filters",key:"depth",value:p});const y=T.clone(t.pivotFetchPayload);return T.isNumpty(e.filters.secondLevel)?y.nextLevel={filter:e.filters.firstLevel,groupBy:e.currentDynamicLevel}:y.nextLevel.groupBy=e.currentDynamicLevel,y.filterBy=ae(e.filters,y.filterBy,R,n,i.item,"id"),y.groupBy=e.currentDynamicLevel,S.getDynamicLevelData(y).then(m=>{if(!m||!m.status)throw"No data";return s("setProperty",{key:"enableNesting",value:!0}),m}).catch(m=>{throw m})},getLeadTooltip(e,t){return S.getLeadTooltip(t).then(s=>s).catch(s=>{throw s})},getFtdsTooltip(e,t){return S.getFtdsTooltip(t).then(s=>s).catch(s=>{throw s})},getPayoutTooltip(e,t){return S.getPayoutTooltip(t).then(s=>s).catch(s=>{throw s})}},fe={namespaced:!0,state:et,getters:tt,actions:st},it="/img/pivot/chart.png",at={name:"ModalPremium",mixins:[re,ne,de],components:{RadiusButtonText:ue},props:{modalPremiumToggle:Boolean,cell:Object,cell_id:String,styleObject:Object},data(){return{}},computed:{computedStyle(){return this.styleObject}},mounted(){},methods:{openSkype(e){e.preventDefault(),e.stopPropagation(),window.location="skype:live:support_54539?chat"},closeElement(e){e.preventDefault(),e.stopPropagation(),this.cell.item.showAppendedElement=!1},stopPropegation(e){e.preventDefault(),e.stopPropagation()}}},H=e=>(he("data-v-f81c4535"),e=e(),ce(),e),lt=H(()=>a("div",{class:"arrow-left"},null,-1)),ot={class:"modal-container"},rt=H(()=>a("img",{width:15,src:be,alt:"Error img"},null,-1)),nt=[rt],dt=H(()=>a("div",{class:"header"},[a("div",{class:"title"},"Premium feature!"),a("div",{class:"sub-title"},"Upgrading to premium plan will unlock it.")],-1)),ut={class:"body"},ht={class:"left"},ct=H(()=>a("div",{class:"title"},"24 hour Insights to your traffic!",-1)),pt={class:"up-text"},yt=H(()=>a("div",null,"Deposits for every hour of the day!",-1)),mt={class:"down-text"},ft=H(()=>a("div",null,"performance in the last 30 days and",-1)),vt=H(()=>a("div",null,"optimise your traffic.",-1)),gt=H(()=>a("small",{class:"small-text"},[E(" *You can remove this column from the customize columns "),a("br"),E(" button on the right ")],-1)),bt=H(()=>a("div",{class:"right",style:{}},[a("img",{style:{width:"100%"},src:it,alt:""})],-1)),kt={class:"footer-pre"};function Lt(e,t,s,i,r,l){const o=D("Icon"),n=D("radius-button-text"),p=X("close-div");return J((d(),c("div",{class:"wrapper",onClick:t[1]||(t[1]=(...y)=>l.stopPropegation&&l.stopPropegation(...y)),style:$(l.computedStyle)},[lt,a("div",ot,[a("div",{onClick:t[0]||(t[0]=(...y)=>l.closeElement&&l.closeElement(...y)),style:{position:"absolute",top:"8px",cursor:"pointer"},class:"x-btn"},nt),dt,a("div",ut,[a("div",ht,[ct,a("div",pt,[a("div",null,[g(o,{style:{fontSize:"1.3rem",position:"relative",top:"5px"},icon:"mingcute:check-fill"}),E(" Now you can see the amount of Leads\\ ")]),yt]),a("div",mt,[a("div",null,[g(o,{style:{fontSize:"1.3rem",position:"relative",top:"5px"},icon:"mingcute:check-fill"}),E(" With our graph,it's easy to view your hourly ")]),ft,vt,gt])]),bt]),a("div",kt,[g(n,{onRadiusButtonTriggered:l.openSkype,bgColor:"white",fgColor:"black",mg:"wide",options:{fontWeight:"bold",height:"35px"}},{default:x(()=>[E(" Contact Us! ")]),_:1},8,["onRadiusButtonTriggered"])])])],4)),[[p,l.closeElement]])}const le=W(at,[["render",Lt],["__scopeId","data-v-f81c4535"]]),wt={class:"statistics-overlay-lead"},Pt={key:0},_t={key:1,style:{overflow:"auto","max-height":"300px"}},Ct={style:{"margin-top":"10px",display:"flex","max-height":"250px"}},Dt={for:"item"},Ft={style:{"margin-left":"25px"},class:"key",for:"key"},At={style:{"margin-top":"10px",display:"flex","max-height":"250px"}},Tt={for:"item"},Mt={style:{"margin-left":"25px"},class:"key",for:"key"},xt={key:2},Ot={style:{"margin-top":"10px",display:"flex","max-height":"250px"}},Et={for:"item"},It={style:{"margin-left":"35px"},class:"key",for:"key"},$t={__name:"PivotToolTipMapped",props:{cell:Object},setup(e){const t=e,s=K(null),i=ke(),r=K(!0),l=K(0),o=Z(()=>[{index:0,id:"mapped",label:"Mapped",hidden:!1},{index:1,id:"original",label:"Original",hidden:!1}]),n=K({mapped:{},original:{}}),p=Le(),y=Z(()=>p.state.pivot.preventApi);function m(F,f){let w=F===""?"Looks like something went wrong. Please try again":F;p.dispatch("toast/error",w).then(()=>{f&&console.log(f)})}function v(F){if(!y.value)try{p.dispatch("pivot/stateFetchPivotTooltipData",{currentDepth:t.cell.item.depth,item:t.cell.item,key:t.cell.key}).then(f=>{let w={};t.cell.item.state.loading=!1;for(let k in f.data.original)w[k]=`${f.data.original[k]}  -  ${(f.data.original[k]/t.cell.item.leads*100).toFixed(2)+"%"}`;n.value=f.data,n.value.original={...w},r.value=!1,i.helper.getType(f.data.mapped)==="array"&&(l.value=1)}),s.value.toggle(F)}catch(f){m(f&&f.msg?f.msg:"")}}return(F,f)=>{const w=X("tooltip");return d(),c("div",wt,[a("div",{onClick:v,style:{width:"20px",display:"flex","align-items":"center","justify-content":"flex-start"}},[y.value?(d(),V(Q(we),{key:0,icon:"eos-icons:bubble-loading",width:"15px"})):_("",!0),y.value?_("",!0):J((d(),c("div",{key:1,class:"mask-svg-image info-icon",style:$({"--imgSrc":"url(/img/i.svg)",height:"15px",width:"15px"})},null,4)),[[w,"Click here to get data"]])]),g(Q(Pe),{ref_key:"op",ref:s},{default:x(()=>[r.value?(d(),c("label",Pt,"Loading...")):(l.value==0||l.value==1)&&n.value.hasOwnProperty("mapped")?(d(),c("div",_t,[g(je,{"active-index":l.value,"onUpdate:activeIndex":f[0]||(f[0]=k=>l.value=k),tabs:o.value},null,8,["active-index","tabs"]),l.value==0?(d(!0),c(O,{key:0},N(n.value.mapped,(k,j)=>(d(),c("div",Ct,[a("label",Dt,L(j)+": ",1),a("label",Ft,L(k),1)]))),256)):_("",!0),l.value==1?(d(!0),c(O,{key:1},N(n.value.original,(k,j)=>(d(),c("div",At,[a("label",Tt,L(j),1),E(": "),a("label",Mt,L(k),1)]))),256)):_("",!0)])):(d(),c("div",xt,[(d(!0),c(O,null,N(n.value,(k,j)=>(d(),c("div",Ot,[a("label",Et,L(j),1),E(": "),a("label",It,L(k),1)]))),256))]))]),_:1},512)])}}},Rt=W($t,[["__scopeId","data-v-d0554c7c"]]),St={name:"AutoLoginIcon",components:{},props:{cell:Object},data(){return{}},computed:{...pe({loadingChart:e=>e.pivot.loadingChart,infoAutoLogin:e=>e.pivot.infoAutoLogin,autologinModal:e=>e.pivot.autologinModal,filters:e=>e.pivot.filters})},beforeCreate(){this.$store.hasModule("pivot")||this.$store.registerModule("pivot",fe)},mounted(){},methods:{...ye({ALFetch:"pivot/ALFetch"}),autoLoginChartCallback(){this.handleDepthData(this.cell.item),this.$store.commit("pivot/setProperty",{key:"loadingChart",value:!0}),this.ALFetch({currentDepth:this.cell.item.depth,item:this.cell.item}).then(e=>{e.data.status&&(this.$store.commit("pivot/setProperty",{key:"loadingChart",value:!1}),this.$store.commit("pivot/setProperty",{key:"autologinModal",value:!0}))}).catch(e=>{this.$store.commit("pivot/setProperty",{key:"loadingChart",value:!1}),this.$store.commit("pivot/setProperty",{key:"autologinModal",value:!1}),this.sendError(e)})},handleDepthData(e){this.$store.commit("pivot/setProperty",{nested:"infoAutoLogin",key:"ai",value:""}),this.$store.commit("pivot/setProperty",{nested:"infoAutoLogin",key:"li",value:""});const t={0:[this.filters.firstLevel],1:[this.filters.firstLevel,this.filters.secondLevel],2:[this.filters.firstLevel,this.filters.secondLevel,this.filters.thirdLevel],3:[this.filters.firstLevel,this.filters.secondLevel,this.filters.thirdLevel,this.filters.fourthLevel]},s={0:[e.name],1:[e.name],2:[e.name],3:[e.name]};e.depth>2&&(s[3]=[e.parent.parent.parent.name]),e.depth>1&&(s[2]=[e.parent.parent.name]),e.depth>0&&(s[1]=[e.parent.name]),t[e.depth].reverse().forEach((r,l)=>{r==="affiliates"&&this.$store.commit("pivot/setProperty",{nested:"infoAutoLogin",key:"ai",value:s[l][0]}),r==="country"&&this.$store.commit("pivot/setProperty",{nested:"infoAutoLogin",key:"li",value:s[l][0]})})}}};function Nt(e,t,s,i,r,l){const o=D("Icon"),n=X("tooltip");return J((d(),c("div",{onClick:t[0]||(t[0]=(...p)=>l.autoLoginChartCallback&&l.autoLoginChartCallback(...p))},[g(o,{class:"iconify",icon:"ic:twotone-data-usage",height:"2rem",style:{display:"flex"}})])),[[n,s.cell.item.auto_login_chart_tooltip]])}const Bt=W(St,[["render",Nt],["__scopeId","data-v-8fd7c2a5"]]),Ht=_e({name:"Pivot",mixins:[re,ne,Ce,De,de,Ve],components:{Chart:Ne,Dialog:Fe,DynamicFilter:He,CustomHeader:ge,SelectBox:Ae,TbTable:Te,SimpleToggle:Me,MainModal:xe,RadiusButtonText:ue,MobileModeFields:Be,LoadingComponent:Oe,ChartPremium:le,DatePicker:Ee},setup(){const e=oe(),s=Ue("PIVOT").getTimeframe();return{v$:Ie(),fetchDataTimeframe:s,dataComp:e}},data(){return{sortKey:"name",sortDirection:"desc",finalDate:"",modalPremiumToggle:!1,displayChartPermisstions:!0,insightsModal:!1,showMobileFilters:!1,addDayBtnEnabled:!1,validWorkingDays:!0,collapseFilters:!1,chartOptions:{cutout:"60%",plugins:{legend:{position:"bottom",labels:{usePointStyle:!0}}}},showFilters:!1,presets:!1,preventExport:!1,limitReportBySo:!1,limitImpressionsCap:2e6,rowToolTipTitles:{leads:"Call status",ftds:{ftdByType:"Segmentation by FTD's type",ftdByDate:"FTDs by registration date"},real_ftds:{ftdByDate:"FTDs by registration date"},payout:"Payout by type"}}},beforeCreate(){this.$store.hasModule("pivot")||this.$store.registerModule("pivot",fe)},mounted(){this.clearFilters(),this.clearAdvancedFilters(),this.setIncludePricing(),this.stateGetLists().then(async()=>{this.getDateDiffNumber()>31&&this.handleChartDisplay("hidden",!1),this.generate()}).catch(e=>{this.sendError("",e)})},computed:{...pe({loading:e=>e.pivot.loading,chartDataAutoLogin:e=>e.pivot.chartDataAutoLogin,filters:e=>e.pivot.filters,data:e=>e.pivot.data,lists:e=>e.pivot.lists,enableNesting:e=>e.pivot.enableNesting,days:e=>e.pivot.days,dayOptions:e=>e.pivot.dayOptions,includePricing:e=>e.pivot.includePricing,chartData:e=>e.pivot.chartData,chartMetadata:e=>e.pivot.chartMetadata,enableChart:e=>e.pivot.enableChart,currentDynamicLevel:e=>e.pivot.currentDynamicLevel,autologinStatusButton:e=>e.pivot.autologinStatusButton,allowChart:e=>e.pivot.allowChart,loadingChart:e=>e.pivot.loadingChart,infoAutoLogin:e=>e.pivot.infoAutoLogin}),autologinModal:{get(){return this.$store.state.pivot.autologinModal},set(e){this.$store.commit("pivot/setProperty",{key:"autologinModal",value:e})}},modifiedChartData(){let e="";return this.helper.isNumpty(this.filters.dateRange[0])||(e=`${this.filters.dateRange[0].split("-").reverse().join("/")} - ${this.filters.dateRange[1].split("-").reverse().join("/")}`),{Date:e,Affiliate:this.infoAutoLogin.ai,Country:this.infoAutoLogin.li,TotalLeads:{name:"Total Leads",value:this.chartDataAutoLogin.totalLeads},Didntuseautologin:{name:"Didn't use Auto Login",value:`${this.chartDataAutoLogin.aNotused} (${this.chartDataAutoLogin.notUsedPercent})`,color:this.COLOR_THEME.warning},LoginIPUnmatched:{name:"Login IP Unmatched",value:`${this.chartDataAutoLogin.aNotMatch} (${this.chartDataAutoLogin.totalNotMatchPercent})`,color:"orange"},LoginIPMatched:{name:"Login IP Matched",value:`${this.chartDataAutoLogin.aMatch} (${this.chartDataAutoLogin.totalMatchPercent})`,color:"green"}}},...$e({levelsListPerLevel:"pivot/levelsListPerLevel",exportPayload:"pivot/exportPayload",pivotFetchPayload:"pivot/pivotFetchPayload"}),setChartDataAutoLogin(){return{labels:["Not Used","Matched","UnMatched"],datasets:[{data:[this.chartDataAutoLogin.aNotused,this.chartDataAutoLogin.aMatch,this.chartDataAutoLogin.aNotMatch],backgroundColor:[this.COLOR_THEME.warning,"green","orange"],borderWidth:0}]}},basicData(){const e=this.chartData.map(l=>Number(l.sumLeads)),t=this.chartData.map(l=>Number(l.sumFtds)),s=this.chartData.map(l=>`${l.hour.toString()}:00`),i={borderWidth:2,borderRadius:Number.MAX_VALUE,backgroundColor:this.COLOR_THEME.primary,data:[...e],label:"Leads"},r={borderWidth:2,borderRadius:Number.MAX_VALUE,backgroundColor:this.COLOR_THEME.secondary,data:[...t],label:"FTDs"};return{labels:s,datasets:[i,r]}},basicOptionsComputed(){return{plugins:{legend:{display:!0,labels:{color:this.lightMode===1?"black":this.COLOR_THEME.text}}},scales:{y:{ticks:{color:this.lightMode===1?"black":"white"},grid:{color:this.lightMode===1?"black":"white"}},x:{ticks:{color:this.lightMode===1?"black":"white"},grid:{color:(this.lightMode===1,"transparent")}}}}},modalBind(){return{modalPremiumToggle:this.modalPremiumToggle}},mainFieldData(){return{title:"Day",options:this.dayOptions,key:"day"}},subFieldData(){return{title:"Hours",options:{from:this.time.startTime,to:this.time.endTime},key:"hours"}},time(){let e=[],t=[];for(let s=0;s<=24;s++){let i=("0"+s).slice(-2),l={name:i+":00",id:i};e.push(l),t.push(l)}return{startTime:e,endTime:t}},depthColors(){return[this.COLOR_THEME.primary,this.COLOR_THEME.darkBg,this.COLOR_THEME.heavyGrey,this.COLOR_THEME.grey]},fields(){return this.lists.columns.map(e=>(e.formatter&&(e.formatter=this.addCurrencySymbol),e.key==="name"&&(e.default=!0),e.key==="insights"&&(e.icon={src:"/img/menu/new_menu_icons/premium.svg",style:{width:"60px"}}),e))},allowedFields(){return this.lists.columns.map(e=>e.key)},config(){return{showMobileFilters:this.showMobileFilters,search:this.data.length>0,dbSearch:!1,drag:this.data.length>0,horizontal:!0,sticky:!1,export:this.data.length>0,nesting:this.enableNesting,pagination:!1,footer:[{key:"name",action:this.nameFooter()},...this.allowedFields.includes("impressions")?[{key:"impressions",action:"sum"}]:[],{key:"clicks",action:"sum"},{key:"failures",action:"sum"},...this.allowedFields.includes("unqualified_leads")?[{key:"unqualified_leads",action:"sum"}]:[],{key:"leads",action:"sum"},...this.allowedFields.includes("unqualified_ftds")?[{key:"unqualified_ftds",action:"sum"}]:[],{key:"ftds",action:"sum"},...this.allowedFields.includes("soft_failures")?[{key:"soft_failures",action:"sum"}]:[],...this.allowedFields.includes("hard_failures")?[{key:"hard_failures",action:"sum"}]:[],...this.allowedFields.includes("unassigned")?[{key:"unassigned",action:"sum"}]:[],{key:"payout",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0},...this.allowedFields.includes("revenue")?[{key:"revenue",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("deposits")?[{key:"deposits",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("chargebacks")?[{key:"chargebacks",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("withdraws")?[{key:"withdraws",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("bonus")?[{key:"bonus",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("bets")?[{key:"bets",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("stake")?[{key:"stake",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("ggr")?[{key:"ggr",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("ngr")?[{key:"ngr",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("epc")?[{key:"epc",action:this.footerSum(this.lists.rev_stats,"clicks",this.lists.currency.symbol)}]:[],...this.allowedFields.includes("epl")?[{key:"epl",action:this.footerSum(this.lists.rev_stats,"leads",this.lists.currency.symbol)}]:[],...this.allowedFields.includes("epf")?[{key:"epf",action:this.footerSum(this.lists.rev_stats,"ftds",this.lists.currency.symbol)}]:[],...this.allowedFields.includes("ctr")?[{key:"ctr",action:this.footerSum("clicks","impressions","%")}]:[],...this.allowedFields.includes("ctl")?[{key:"ctl",action:this.footerSum("leads","clicks","%")}]:[],...this.allowedFields.includes("cr")?[{key:"cr",action:this.footerSum("ftds","leads","%")}]:[],...this.allowedFields.includes("pl")?[{key:"pl",action:"sum",text:this.lists.currency.symbol,decimal:2,commas:!0}]:[],...this.allowedFields.includes("roi")?[{key:"roi",action:this.footerSum("revenue","payout","%")}]:[]],rowActions:[...this.enableChart&&this.displayChartPermisstions?[{fieldKey:"insights",callback:"insightsModalHandle",key:"insights",bgColor:this.COLOR_THEME.gradient,fieldLabel:"24 Insights",button:{bgColor:this.COLOR_THEME.primary,fgColor:"black",mg:"narrow",rd:"max",options:{width:"150px"},text:"24 Insights"}}]:[],...this.lists.hasDynamicLevel?[{fieldKey:"dynamicLevel",callback:"handleDynamicLevel",showCondition:{key:"isDynamicLevel",value:!0,falsy:!0},isOn:{key:"hasDynamicChildren",value:!0},button:{bgColorHover:this.COLOR_THEME.primary,bgColor:"transparent",fgColorHover:this.COLOR_THEME.blackAndWhite,fgColor:this.COLOR_THEME.grey,mg:"narrow",rd:"max",options:{width:"150px"},text:this.helper.upperFirst(this.currentDynamicLevel)}}]:[]],rowTooltip:[{key:"name",field:"id",hideValue:!0,showCondition:{key:"isDynamicLevel",value:!1,falsy:!0}},{key:"ftds",api:!0},{key:"payout",api:!0},{key:"real_ftds",api:!0}],appendElement:[{key:"insights",asComponent:G(le),hideValue:!0,styleObject:{position:"absolute",left:"160px",top:"50%","z-index":10}},{key:"leads",showCondition:{key:"leads",value:"0",falsy:!0},asComponent:G(Rt),show:!0},...this.autologinStatusButton?[{key:"auto_login_chart",asComponent:G(Bt),show:!0}]:[]],css:[{key:"name",style:{color:this.COLOR_THEME.primary,display:"inline"},showCondition:{key:"isDynamicLevel",value:!0}}]}},formFields(){return[{key:"filters",class:"filters-container",style:{width:"100%"},minimize:!0,filters:[...this.helper.isNumpty(this.lists.affiliates)?[]:[{title:"Affiliates",labelStyle:{},labelClass:"filter_label",key:"affiliates",is:"select-box",condition:!0,style:{},class:["filter-component"],errors:{required:"This Field is Required"},name:"affiliates",options:this.lists.affiliates,single:!1,customPlaceholder:"All Affiliates","sort-key":null,value:this.filters.affiliates}],...this.helper.isNumpty(this.lists.countries)?[]:[{title:"Countries",labelStyle:{},labelClass:"filter_label",key:"countries",is:"select-box",condition:!0,style:{},class:["filter-component"],errors:{required:"This Field is Required"},name:"countries",options:this.lists.countries,single:!1,customPlaceholder:"All Countries","sort-key":null,value:this.filters.countries}],...this.helper.isNumpty(this.lists.campaigns)?[]:[{title:"Campaigns",labelStyle:{},labelClass:"filter_label",key:"campaigns",is:"select-box",condition:!0,style:{},class:["filter-component"],errors:{required:"This Field is Required"},name:"campaigns",options:this.lists.campaigns,single:!1,customPlaceholder:"All Campaigns","sort-key":null,value:this.filters.campaigns}],...this.helper.isNumpty(this.lists.boxes)?[]:[{title:"Boxes",labelStyle:{},labelClass:"filter_label",key:"boxes",is:"select-box",condition:!0,style:{},class:["filter-component"],errors:{required:"This Field is Required"},name:"boxes",options:this.lists.boxes,single:!1,customPlaceholder:"All Boxes","sort-key":null,value:this.filters.boxes}],...this.helper.isNumpty(this.lists.brands)?[]:[{title:"Brands",labelStyle:{},labelClass:"filter_label",key:"brands",is:"select-box",condition:!0,style:{},class:["filter-component"],errors:{required:"This Field is Required"},name:"brands",options:this.lists.brands,single:!1,customPlaceholder:"All Brands","sort-key":null,value:this.filters.brands}]]}]},timeRangeFilter(){return[{title:"Date Range*",labelStyle:{},labelClass:"filter_label",key:"dateRange",is:"DatePicker",condition:!0,style:{},class:["filter-component"],errors:{required:"This Field is Required"},placeholder:"Choose a date range",format:"DD/MM/YY",shortcuts:this.dateTimeShortcuts,"range-separator":"-",name:"date-picker",type:"daterange",ref:"daterange",confirm:!0,range:!0,disabled:!1,value:this.mixinValue}]},filterButtons(){return[{title:"",labelStyle:{},labelClass:"filter_label",key:"filter",is:"radius-button-text",condition:!0,"clear-btn":!1,style:{width:"100%"},class:["filter-btn","filter-component","generate-btn","filter-wrapper"],options:{disabled:this.loading},bgColor:this.COLOR_THEME.toggleBg,fgColor:"white",rd:"min",text:"Advanced Filter"},{title:"",labelStyle:{},labelClass:"filter_label",key:"filter-btn-key",is:"radius-button-text",condition:!0,style:{},class:["filter-btn","filter-component","generate-btn"],options:{disabled:this.loading},bgColor:this.COLOR_THEME.primary,fgColor:this.COLOR_THEME.text_ngtv,mg:"wide",rd:"min",text:"Generate"}]},pivotLevels(){return[{key:"levels",class:"filters-container",style:{width:"100%"},filters:[...this.timeRangeFilter,{title:"First Level*",labelStyle:{},labelClass:"filter_label",key:"firstLevel",is:"select-box",condition:!0,style:{},class:["filter-component"],errors:{required:"This Field is Required"},name:"First Level",sortKey:"name",options:this.levelsListPerLevel.firstLevel,single:!0,customPlaceholder:"First Level",disabled:!1,"sort-key":null,value:this.filters.firstLevel},{title:"Second Level",labelStyle:{},labelClass:"filter_label",key:"secondLevel",is:"select-box",condition:!0,style:{},class:["filter-component"],name:"Second Level",sortKey:"name",options:this.levelsListPerLevel.secondLevel,single:!0,customPlaceholder:"Second Level",disabled:this.helper.isNumpty(this.filters.firstLevel),"sort-key":null,value:this.filters.secondLevel},{title:"Third Level",labelStyle:{},labelClass:"filter_label",key:"thirdLevel",is:"select-box",condition:!0,style:{},class:["filter-component"],name:"Third Level",sortKey:"name",options:this.levelsListPerLevel.thirdLevel,single:!0,customPlaceholder:"Third Level",disabled:this.helper.isNumpty(this.filters.secondLevel),"sort-key":null,value:this.filters.thirdLevel},{title:"Fourth Level",labelStyle:{},labelClass:"filter_label",key:"fourthLevel",is:"select-box",condition:!0,style:{},class:["filter-component"],name:"Fourth Level",sortKey:"name",options:this.levelsListPerLevel.fourthLevel,single:!0,customPlaceholder:"Fourth Level",disabled:this.helper.isNumpty(this.filters.thirdLevel),"sort-key":null,value:this.filters.fourthLevel},...this.filterButtons]}]},pivotPresets(){return[{key:"presets",class:"filters-container",style:{width:"100%"},filters:[...this.timeRangeFilter,{title:"Presets",labelStyle:{},labelClass:"filter_label",key:"preset",is:"select-box",condition:!0,style:{},class:["filter-component"],name:"Presets",options:this.lists.presets,errors:{required:"This Field is Required"},single:!0,customPlaceholder:"Select Preset",disabled:!1,"sort-key":"name",value:this.filters.preset},...this.filterButtons]}]},Levels(){return this.presets?this.pivotPresets:this.pivotLevels},formEvents(){},tableBinds(){return{loading:this.loading,items:this.data,fields:this.fields,"search-columns":this.fields,config:this.config,"total-items":this.data.length,sortKey:this.sortKey}},tableEvents(){return{onTableTools:this.doToolActions,onTableActions:this.doTableActions,onRowActions:this.doRowAction,rowClicked:this.doRowClicked,sort:this.updateSort}},allowExport(){return!!this.exportPayload.levels.length&&this.checkExportValidity(this.filters.dateRange)}},methods:{...ye({stateGetLists:"pivot/stateGetLists",stateFetchCampaignsByAffiliate:"pivot/stateFetchCampaignsByAffiliate",stateFetchPivot:"pivot/stateFetchPivot",stateFetchPivotNestedData:"pivot/stateFetchPivotNestedData",stateClearLevels:"pivot/stateClearLevels",stateAllocatePreset:"pivot/stateAllocatePreset",statePivotExport:"pivot/statePivotExport",stateFetchPivotTooltipData:"pivot/stateFetchPivotTooltipData",stateClearFilters:"pivot/stateClearFilters",stateClearAdvancedFilters:"pivot/stateClearAdvancedFilters",stateDeleteRow:"pivot/stateDeleteRow",stateRemoveHour:"pivot/stateRemoveHour",stateAddHour:"pivot/stateAddHour",stateAddDay:"pivot/stateAddDay",stateUpdateDay:"pivot/stateUpdateDay",statePivotHourlyFetch:"pivot/statePivotHourlyFetch",stateGetDynamicLevelData:"pivot/stateGetDynamicLevelData",ALFetch:"pivot/ALFetch"}),updateSort(e,t){this.sortKey=e,this.sortDirection=t},getDateDiffNumber(){return this.helper.getDateDifferenceIn(this.filters.dateRange[0],this.filters.dateRange[1])},handleChartDisplay(e,t){let s=this.lists.columns.find(i=>i.key==="insights");this.helper.isNil(s)||(s[e]=t,this.displayChartPermisstions=t)},insightsModalHandle(e){if(e.item.showAppendedElement){e.item.showAppendedElement=!1;return}if(!e.item.showChart){this.$store.commit("pivot/updateIndexInArray",{array:"data",iterator:"id",iterator_value:e.item.id,key:"showAppendedElement",value:!0,toggle:!0});return}return this.$store.commit("pivot/setProperty",{key:"loadingChart",value:!0}),this.statePivotHourlyFetch({currentDepth:e.item.depth,item:e.item}).then(t=>{if(window.helper.isNil(t))return;if(t===!1){this.modalPremiumToggle=!0;return}this.insightsModal=!0;const s=r=>{let l={},o=r[0].split("-"),n=o[2]+"/"+o[1]+"/"+o[0],p=r[1].split("-"),y=p[2]+"/"+p[1]+"/"+p[0];return l=n+"-"+y,{updatedD:l}},{updatedD:i}=s(this.filters.dateRange);this.finalDate=i}).catch(t=>{const s=t?"":"Cannot get data longer than one month. Please change your date range and try again";this.sendError(s,t)}).finally(()=>{this.$store.commit("pivot/setProperty",{key:"loadingChart",value:!1})})},setIncludePricing(){if(!this.helper.isNil(this.$localStorage.getItem("include-pricing"))){let e=JSON.parse(this.$localStorage.getItem("include-pricing"));this.$store.commit("pivot/setProperty",{key:"includePricing",value:e})}},setPricing(e){this.$localStorage.setItem("include-pricing",JSON.stringify(e)),this.$store.commit("pivot/setProperty",{key:"includePricing",value:e})},addDay(){this.stateAddDay()},addHour(e){this.stateAddHour(e)},removeHour(e){this.stateRemoveHour(e)},deleteRow(e){this.stateDeleteRow(e)},updateDayHoursFilter(e){switch(e.type){case"updateDay":this.stateUpdateDay(e)}this.validWorkingDays=!e.item.error},handleButtonActions(e){switch(e){case"filter":return this.showFilters=!this.showFilters;default:return this.generate()}},styleLevel(e){return(e.key==="secondLevel"||e.key==="fourthLevel")&&innerWidth<=650?{margin:"0"}:{}},clearAdvancedFilters(){this.stateClearAdvancedFilters()},clearFilters(){this.stateClearFilters().then(()=>{this.$store.commit("pivot/setProperty",{nested:"filters",key:"dateRange",value:this.initDate(this.fetchDataTimeframe)})})},footerSum(e,t,s){let i=0,r=0,l=0;return this.helper.isNumpty(this.data)||!this.helper.isArray(this.data)?"":(this.data.forEach(o=>{let n=this.helper.regexDecimal.exec(o[e]),p=this.helper.regexDecimal.exec(o[t]);i+=Number(n?n[0]:0),r+=Number(p?p[0]:0)}),l=r===0?0:i/r,s==="%"&&(l*=100),l=this.helper.addCommas(l.toFixed(2)),s?s==="%"?l+s:s+l:l)},nameFooter(){return"Total "},addCurrencySymbol(e,t=2){if(this.helper.isNil(e))return"";if(!this.helper.isNil(this.helper.addCommas(e,t)))return this.lists.currency.symbol+this.helper.addCommas(e,t)},validateFormErrors(e){return e.errors&&this.v$.filters[e.key]&&this.v$.filters[e.key].$error},handleOnInput(e,t){switch(this.helper.getType(e)){case"object":this.$store.commit("pivot/setProperty",{nested:"filters",key:t,value:e.target.value});break;case"array":let s=e;t==="dateRange"&&(s=e[0]!==null&&e[1]!==null&&e.length?this.parseTime(e):[]),this.$store.commit("pivot/setProperty",{nested:"filters",key:t,value:s});break;case"string":this.$store.commit("pivot/setProperty",{nested:"filters",key:t,value:e});break;case null:this.$store.commit("pivot/setProperty",{nested:"filters",key:t,value:null});break}t.includes("Level")&&this.adjustLevels(t,e),t.includes("preset")&&(this.filters.preset=e,this.handlePresets(t,e)),t.includes("affiliates"),t==="dateRange"&&(e[0]===null&&e[1]===null&&!e.length?this.mixinValue=[]:this.mixinValue=e)},generate(){this.v$.$touch(),!(this.v$.$invalid||this.loading||!this.validWorkingDays)&&(this.showMobileFilters=!1,this.stateFetchPivot().then(()=>{this.getDateDiffNumber()>31?this.handleChartDisplay("hidden",!0):(this.handleChartDisplay("hidden",!1),this.displayChartPermisstions=!0),this.enableExport()}).catch(e=>{this.sendError(e&&e.msg?e.msg:"",e)}))},onRowTooltip(e,t,s,i,r){e.item.state.loading=!0,this.stateFetchPivotTooltipData({currentDepth:e.item.depth,item:e.item,key:e.key}).then(l=>{e.item.state.loading=!1,this.helper.isNumpty(l)?r(e,[]):e.key==="ftds"||e.key==="real_ftds"?this.handleTooltip(l,e,r):this.handleDefaultTooltip(l,e,r)}).catch(l=>{this.sendError("",l)})},handleTooltip(e,t,s){let i="";const r=this.rowToolTipTitles[t.key];for(let l in r)this.helper.isEmpty(e[l])||(i+=this.createTooltipString(r[l],e[l]));t.item.state.loading=!1,s(t,i)},handleDefaultTooltip(e,t,s){let i=this.rowToolTipTitles[t.key],r=this.createTooltipString(i,e);s(t,r)},createTooltipString(e,t){let s=`<div style="padding: 5px; text-align: left;max-height: 400px;overflow-y: auto"><p><b style="color: ${this.COLOR_THEME.primary}">${e}:</b></p>`;return s+=this.getToolTipKeyValues(t),s},getToolTipKeyValues(e){let t="";for(let s in e)t+=`<p style="padding: 5px;display:flex;justify-content: space-between;width:fit-content;">
                            <span style="margin-right:10px;min-width:150px; width:fit-content"> ${s}</span>
                            <span> ${e[s]} </span>
                            </p>`;return t+="</div>",t},async onNesting(e,t){if(e.item.state.loading=!0,e.item.showNesting){this.$store.commit("pivot/setProperty",{key:"data",value:this.applyNesting(this.data,e,e.item.children,"id",!0)}),e.item.state.loading=!1;return}this.stateFetchPivotNestedData({currentDepth:e.item.depth,item:e.item,rule:t}).then(s=>{let i=this.helper.isNumpty(s)?"0":this.helper.sortArrayByKey(s,this.sortKey,this.sortDirection);this.$store.commit("pivot/setProperty",{key:"data",value:this.applyNesting(this.data,e,i,"id",!0)})}).catch(s=>{this.sendError(s&&s.msg?s.msg:"",s)}).finally(()=>{e.item.state.loading=!1})},checkExportValidity(e){return e==null?!1:Re(new Date(e[1])).diff(new Date(e[0]),"months",!0)<6},exportTable(e,t){if(!this.allowExport){this.sendError("Please validate your filters. Select a maximum time frame of 6 months."),t();return}const s=e.filter(i=>!i.hidden&&i.key!=="insights").map(i=>i.key);this.statePivotExport(s).then(()=>{this.sendMsg(`Your export is being processed.</br> We will let you know as soon as it is ready <a href="/v2/reports/export" target='blank'>Export URL</a>`)}).catch(i=>{console.log("PIVOT EXPORT ERROR: ",i),this.sendError("",i)}).finally(()=>{t()})},adjustLevels(e,t){switch(e){case"firstLevel":this.stateClearLevels({level:e,levels:["secondLevel","thirdLevel","fourthLevel"],value:t});break;case"secondLevel":this.stateClearLevels({level:e,levels:["thirdLevel","fourthLevel"],value:t});break;case"thirdLevel":this.stateClearLevels({level:e,levels:["fourthLevel"],value:t});break}},handlePresets(e,t){t!==null&&this.stateAllocatePreset(t).catch(s=>{this.sendError("",s)})},updateDynamicLevel(e){this.$store.commit("pivot/setProperty",{key:"currentDynamicLevel",value:e})},handleDynamicLevel(e){if(e.item.state.loading=!0,this.helper.isNumpty(this.filters.secondLevel)&&this.$store.commit("pivot/setObject",{path:"filters.secondLevel",value:this.currentDynamicLevel}),e.item.showNesting){const s=!this.helper.isNumpty(this.filters.secondLevel)?e.item.children:"0";this.$store.commit("pivot/setProperty",{key:"data",value:this.applyNesting(this.data,e,s,"id",!0,!1,"hasDynamicChildren")}),this.data.find(i=>i.showNesting)||this.$store.commit("pivot/setProperty",{key:"enableNesting",value:!this.helper.isNumpty(this.filters.secondLevel)}),e.item.state.loading=!1;return}this.stateGetDynamicLevelData(e).then(t=>{if(window.helper.isNil(t))return;let s=this.helper.isNumpty(t.data)?"0":t.data.map(i=>(i.children="0",i.isDynamicLevel=!0,i.rowColor=this.COLOR_THEME.toggleBg,i));this.$store.commit("pivot/setProperty",{key:"data",value:this.applyNesting(this.data,e,s,"id",!0,!1,"hasDynamicChildren",!0)})}).catch(t=>{this.sendError("",t)}).finally(()=>{e.item.state.loading=!1})}},validations(){let e=["dateRange","firstLevel"],t={};return e.forEach(s=>{this.filters.hasOwnProperty(s)&&(t[s]={required:Se})}),{filters:t}}}),b=e=>(he("data-v-bd35d7fc"),e=e(),ce(),e),jt={id:"tb-pivot"},Vt={class:"color_sysText",style:{"font-weight":"bolder","margin-top":"20px"}},Ut=b(()=>a("div",{class:"color_sysText",style:{"font-weight":"bolder","margin-top":"5px"}},"We are working on fixing this issue as soon as possible",-1)),qt={style:{display:"inline-block",margin:"35px 0"}},Kt={class:"wrapper-header"},Wt={key:0,style:{position:"relative",top:"10px"}},Gt={style:{display:"inline-block",float:"right"}},zt={key:0,style:{display:"inline-block","font-size":"12px"}},Yt={key:1,style:{width:"100%"}},Xt={class:"flex-wrapper"},Jt={class:"filter presetsToggle"},Zt=b(()=>a("span",{class:"select-a-lvl"},"Select a level ",-1)),Qt={class:"wrapper-level"},es={class:"include-pricing"},ts=b(()=>a("span",{class:"select-a-lvl"},"Include Pricing",-1)),ss={class:"toggle-pricing"},is=b(()=>a("label",null,"Off",-1)),as=b(()=>a("label",null,"On",-1)),ls={key:0,class:"error"},os={key:0,class:"advanced-filters-wrapper"},rs=b(()=>a("hr",{class:"base-hr"},null,-1)),ns={key:0,class:"dynamic-level-filter"},ds=b(()=>a("div",{class:"select-a-lvl color_sysPrimary"},"Dynamic Level",-1)),us=b(()=>a("p",null,"This parameters statistics will be shown in every breakdown level.",-1)),hs={class:"select-box-wrapper"},cs={class:"flex-wrapper"},ps={class:"filter excludeToggle"},ys={style:{display:"inline-block",float:"right","font-size":"12px"}},ms=b(()=>a("span",{class:"select-a-lvl"},"Filters",-1)),fs={class:"responsive-header"},vs={class:"header-name"},gs=b(()=>a("span",{class:"toggle-nameId"},"Show by Name",-1)),bs=b(()=>a("span",{class:"toggle-nameId"},"Show by ID",-1)),ks={class:"header-affiliate"},Ls=b(()=>a("p",{class:"line",style:{margin:"0 20px"}},"|",-1)),ws={key:0,class:"error"},Ps={class:"working-day-wrapper"},_s=b(()=>a("div",{class:"hours-header"},"Working days",-1)),Cs=b(()=>a("hr",{class:"base-hr"},null,-1)),Ds={class:"table-container"},Fs=b(()=>a("div",{class:"autologin-wrapper"},[a("h3",{class:"color_sysPrimary"},"Auto Login Usage")],-1)),As={class:"chart-wrapper-autologin"},Ts={class:"info"},Ms={key:0,style:{display:"flex","flex-direction":"column","text-align":"center",gap:"0.5rem"}},xs={key:1,style:{display:"flex","flex-direction":"column","text-align":"center",gap:"0.5rem"}},Os={key:0,class:"chart-auto-login"},Es={style:{"text-align":"center",width:"100%"}},Is=b(()=>a("h3",{style:{"text-align":"center"},class:"color_sysPrimary"},"Average amount of leads per hour (UTC)",-1)),$s={class:"wrapper-text"},Rs=b(()=>a("div",{class:"line"},null,-1)),Ss=b(()=>a("div",{class:"line"},null,-1)),Ns=b(()=>a("label",{class:"amount",for:"Amount"},"Amount",-1)),Bs={style:{padding:"0 45px 20px 45px"}},Hs=b(()=>a("label",{class:"hours",for:"hours"},"Hours",-1)),js={id:"premuim"};function Vs(e,t,s,i,r,l){const o=D("radius-button-text"),n=D("MainModal"),p=D("custom-header"),y=D("MobileModeFields"),m=D("simple-toggle"),v=D("select-box"),F=D("dynamic-filter"),f=D("tb-table"),w=D("Chart"),k=D("Dialog"),j=D("ChartPremium"),ve=D("loading-component");return d(),c("div",jt,[e.limitReportBySo?(d(),V(n,{key:"modal",img:{imgURL:"/img/blue/error2.svg",imgSize:"15"},modelValue:e.limitReportBySo,"onUpdate:modelValue":t[1]||(t[1]=h=>e.limitReportBySo=h),height:"17"},{component:x(()=>[a("template",null,[a("div",Vt,[E(" Currently, SO breakdown is limited to "),a("span",{style:$({color:e.COLOR_THEME.warning})},L(e.limitImpressionsCap),5),E(" records only. ")]),Ut]),a("template",null,[a("div",qt,[g(o,{onRadiusButtonTriggered:t[0]||(t[0]=h=>e.limitReportBySo=!e.limitReportBySo),bgColor:e.COLOR_THEME.warning,fgColor:"white",mg:"wide",rd:"min"},{default:x(()=>[E(" Got it ! ")]),_:1},8,["bgColor"])])])]),_:1},8,["img","modelValue"])):_("",!0),a("div",Kt,[g(p,{title:"Reports"}),g(y,U({ref:"mobileFields"},e.mobileModeFieldsBind,ee(e.mobileModeFieldsActions)),null,16)]),a("div",{class:B(["filters-flex-wrapper filters-container",[{collapsed:e.collapseFilters},{"mobile-field-on":!e.showMobileFilters}]])},[e.collapseFilters?(d(),c("small",Wt,"Filter - Show More")):_("",!0),a("div",Gt,[e.collapseFilters?_("",!0):(d(),c("div",zt,[a("span",{onClick:t[2]||(t[2]=(...h)=>e.clearFilters&&e.clearFilters(...h)),style:{cursor:"pointer"},class:"span-clear-filter color_sysText"},"Clear Filters")])),a("div",{style:{display:"inline-block"},onClick:t[3]||(t[3]=h=>e.collapseFilters=!e.collapseFilters),class:"advanced-search-toggle"},[a("i",{class:B([{toggled:e.collapseFilters},"toggle-arrow"])},null,2)])]),e.collapseFilters?_("",!0):(d(),c("div",Yt,[(d(!0),c(O,null,N(e.Levels,h=>(d(),c("div",{key:h.key,class:B(h.class),style:$(h.style)},[a("div",Xt,[a("div",Jt,[Zt,a("div",Qt,[a("span",{style:{position:"relative"},class:B(["presets-text",{on:!e.presets}])},"Manual",2),g(m,{style:{position:"relative",left:"10px"},"onUpdate:modelValue":[t[4]||(t[4]=u=>e.stateClearLevels({clear:!0})),t[5]||(t[5]=u=>e.presets=u)],boolean:"","dual-mode":"",modelValue:e.presets},{default:x(()=>[a("span",{style:{position:"relative",left:"8px",bottom:"2px"},class:B(["presets-text",{on:e.presets}])}," Presets ",2)]),_:1},8,["modelValue"]),a("div",es,[ts,a("div",ss,[is,g(m,{style:{margin:"0 10px"},boolean:"",modelValue:e.includePricing,"onUpdate:modelValue":e.setPricing},null,8,["modelValue","onUpdate:modelValue"]),as])])])]),(d(!0),c(O,null,N(h.filters,u=>(d(),c("div",{class:"filter",style:$([e.presets&&u.key==="preset"?{width:"300px"}:{width:"170px"},u.key==="filter-btn-key"&&e.innerWidth<=700?{width:"100%"}:{},e.styleLevel(u)])},[a("small",{class:B(u.labelClass),style:$(u.labelStyle)},L(u.title),7),(d(),V(te(u.is),U({onChange:A=>e.handleOnInput(A,u.key),"onUpdate:modelValue":[(A,q)=>e.handleOnInput(A,u.key),A=>u.value=A],onRadiusButtonTriggered:A=>e.handleButtonActions(u.key),value:u.value,"onUpdate:value":A=>u.value=A,modelValue:u.value},u),null,16,["onChange","onUpdate:modelValue","onRadiusButtonTriggered","value","onUpdate:value","modelValue"])),e.validateFormErrors(u)?(d(),c("small",ls,[(d(!0),c(O,null,N(e.v$.filters[u.key],(A,q)=>(d(),c(O,null,[E(L(u.errors[q]),1)],64))),256))])):_("",!0)],4))),256))])],6))),128)),e.showFilters?(d(),c("div",os,[rs,e.lists.hasDynamicLevel?(d(),c("div",ns,[ds,us,a("div",hs,[g(v,{name:"Dynamic Level",options:this.levelsListPerLevel.firstLevel,single:"",modelValue:e.currentDynamicLevel,"onUpdate:modelValue":e.updateDynamicLevel,"custom-placeholder":"Select Level"},null,8,["options","modelValue","onUpdate:modelValue"])])])):_("",!0),(d(!0),c(O,null,N(e.formFields,h=>(d(),c("div",{key:h.key,class:B(h.class),style:$(h.style)},[a("div",cs,[a("div",ps,[a("div",ys,[a("span",{style:{cursor:"pointer"},class:"span-clear-advanced",onClick:t[6]||(t[6]=u=>e.clearAdvancedFilters())},"Clear Advanced Filter")]),ms,a("div",fs,[a("div",vs,[gs,g(m,{class:"nameOrIdToggle","dual-mode":"",modelValue:e.filters.showIdAsName,"onUpdate:modelValue":t[7]||(t[7]=u=>e.filters.showIdAsName=u)},{default:x(()=>[bs]),_:1},8,["modelValue"])]),a("div",ks,[Ls,g(m,{boolean:"",modelValue:e.filters.excInjectionAI,"onUpdate:modelValue":t[8]||(t[8]=u=>e.filters.excInjectionAI=u)},{default:x(()=>[a("span",{class:B(["toggle-text",{on:e.filters.excInjectionAI}])}," Show Hidden Affiliate Stats ",2)]),_:1},8,["modelValue"])])])]),(d(!0),c(O,null,N(h.filters,u=>(d(),c("div",{key:u.key,class:"filter",style:$([{width:"170px"},(u.key==="affiliates"||u.key==="campaigns")&&e.innerWidth<=650?{margin:"0"}:{}])},[a("small",{class:B(u.labelClass),style:$(u.labelStyle)},L(u.title),7),(d(),V(te(u.is),U({onInput:A=>e.handleOnInput(A,u.key),"onUpdate:modelValue":A=>e.handleOnInput(A,u.key)},u),null,16,["onInput","onUpdate:modelValue"])),e.validateFormErrors(u)?(d(),c("small",ws,[(d(!0),c(O,null,N(e.v$.filters[u.key],(A,q)=>(d(),c(O,null,[E(L(u.errors[q]),1)],64))),256))])):_("",!0)],4))),128))])],6))),128)),a("div",Ps,[_s,g(F,{theme:"dayHourFromTo","data-arr":e.days,"main-field-data":e.mainFieldData,"sub-field-data":e.subFieldData,onAddDay:t[9]||(t[9]=h=>e.addDay(h)),onAddHour:t[10]||(t[10]=h=>e.addHour(h)),onRemoveHour:t[11]||(t[11]=h=>e.removeHour(h)),onDeleteRow:t[12]||(t[12]=h=>e.deleteRow(h)),onUpdate:t[13]||(t[13]=h=>e.updateDayHoursFilter(h))},null,8,["data-arr","main-field-data","sub-field-data"]),e.showFilters?(d(),V(o,{key:0,class:"advanced-mobile",onRadiusButtonTriggered:e.generate,bgColor:e.COLOR_THEME.primary,fgColor:e.COLOR_THEME.text_ngtv,mg:"wide",options:{disabled:e.loading},rd:"min"},{default:x(()=>[E(" Generate ")]),_:1},8,["onRadiusButtonTriggered","bgColor","fgColor","options"])):_("",!0)]),Cs])):_("",!0)]))],2),a("div",Ds,[e.fields.length>0?(d(),V(f,U({key:0,ref:"table"},e.tableBinds,ee(e.tableEvents)),null,16)):_("",!0)]),g(k,{"dismissable-mask":"",visible:e.autologinModal,"onUpdate:visible":t[14]||(t[14]=h=>e.autologinModal=h),style:{width:"60vw"},modal:!0},{header:x(()=>[Fs]),default:x(()=>[a("div",As,[a("div",Ts,[(d(!0),c(O,null,N(e.modifiedChartData,(h,u)=>(d(),c(O,null,[e.helper.isNumpty(h.name)?e.helper.isNumpty(h)?_("",!0):(d(),c("div",xs,[a("span",null,L(u),1),a("span",null,L(h),1)])):(d(),c("div",Ms,[a("span",{style:$({color:h.color})},L(h.name),5),a("span",{style:$({color:h.color})},L(h.value),5)]))],64))),256))]),e.allowChart?(d(),c("div",Os,[g(w,{style:{width:"300px",height:"300px"},type:"pie",data:e.setChartDataAutoLogin,options:e.chartOptions},null,8,["data","options"])])):_("",!0)])]),_:1},8,["visible"]),g(k,{"dismissable-mask":"",visible:e.insightsModal,"onUpdate:visible":t[15]||(t[15]=h=>e.insightsModal=h),style:{width:"65vw"},modal:!0},{header:x(()=>[a("div",Es,[Is,a("div",$s,[a("div",null,L(e.finalDate),1),Rs,a("div",null,"Total Leads: "+L(e.chartMetadata.totalLeads),1),Ss,a("div",null,"Total FTD: "+L(e.chartMetadata.totalFTD),1)])])]),default:x(()=>[a("div",{class:"chart-wrapper",style:$({background:e.COLOR_THEME.eleBg,borderRadius:"8px"})},[Ns,a("div",Bs,[g(w,{type:"bar",legendCols:"3",data:e.basicData,options:e.basicOptionsComputed},null,8,["data","options"])]),Hs],4)]),_:1},8,["visible"]),a("div",js,[g(k,{showHeader:!1,visible:e.modalPremiumToggle,modal:!0},{default:x(()=>[g(j,U({onClose:t[16]||(t[16]=h=>e.modalPremiumToggle=!e.modalPremiumToggle)},e.modalBind),null,16)]),_:1},8,["visible"])]),e.loadingChart?(d(),V(ve,{key:1})):_("",!0)])}const Zs=W(Ht,[["render",Vs],["__scopeId","data-v-bd35d7fc"]]);export{Zs as default};
