import{_,T as k,F as b,bU as F,b as H,e as d,f as i,j as D,aa as A,g as n,t as v,i as u,x as V,al as w,a5 as x,a1 as c,W as p,h as g,p as I,k as C}from"./index-4ykL4QJn.js";const U={mixins:[k,b],name:"DynamicFilter",components:{SelectBox:F},props:{dataArr:{type:Array,required:!0,default:()=>[]},mainFieldData:{type:Object,required:!1,default:()=>{}},subFieldData:{type:Object,required:!1,default:()=>{}},theme:{type:String,required:!1,default:"default"},bottomOpen:{type:Boolean,required:!1,default:!1},displayAddHours:{type:Boolean,required:!1,default:!0}},data(){return{isValidAddDays:!1,tempDataArr:null}},watch:{dataArr:{handler(e){this.tempDataArr=e},immediate:!0}},methods:{divHeight(e){if(!this.helper.isEmpty(this.tempDataArr[e].hours))return this.tempDataArr[e].hours.length>8},updateDataArrDefault(e,a){this.tempDataArr[e.index].value=e.val,this.validateDefault(),this.$emit("update",{type:e.type,index:e.index,val:e.val,item:e.item}),this.validateDefault()},updateDataArrDaysAndHours(e,a){switch(e.type){case"updateDay":this.tempDataArr[e.index][this.mainFieldData.key]=e.val;break;case"updateFromHour":this.tempDataArr[e.index][this.subFieldData.key][e.hourIndex].from=e.val;break;case"updateToHour":this.tempDataArr[e.index][this.subFieldData.key][e.hourIndex].to=e.val;break}this.validateDayAndHours(),this.$emit("update",{type:e.type,index:e.index,hourIndex:e.hourIndex?e.hourIndex:null,val:e.val,item:e.item}),this.validateDayAndHours()},deleteRow(e){this.$emit("deleteRow",{rowIndex:e}),this.tempDataArr.length<=0&&(this.isValidAddDays=!0),this.validateDayAndHours()},validateDefault(){this.tempDataArr.forEach((e,a)=>{e.valid=!0,(this.helper.isNumpty(e.value)||e.error&&a+1===this.tempDataArr.length)&&(e.valid=!1)})},validateDayAndHours(){this.isValidAddDays=!0,this.tempDataArr.forEach(e=>{if(e.valid=!0,e.error=!1,this.helper.isNumpty(e[this.mainFieldData.key])){this.isValidAddDays=!1,e.valid=!1;return}e[this.subFieldData.key].forEach(a=>{this.helper.isNil(a.from)&&this.helper.isNil(a.to)?(this.isValidAddDays=!1,e.valid=!1):(this.helper.isNil(a.from)||this.helper.isNil(a.to)||a.from>=a.to)&&(e.error=!0,e.valid=!1,this.isValidAddDays=!1)})})},addHour(e,a){e.valid&&this.$emit("addHour",{itemIndex:a}),this.validateDayAndHours()},removeHour(e,a){this.$emit("removeHour",{itemIndex:e,hourIndex:a}),this.validateDayAndHours()},addDay(){this.isValidAddDays&&this.$emit("addDay"),this.validateDayAndHours()},toggleHours(e,a,t){if(t+1===e[this.subFieldData.key].length){this.addHour(e,a);return}t+1<e[this.subFieldData.key].length&&this.removeHour(a,t)},addParam(e,a){e.valid&&this.$emit("addParam",{itemIndex:a}),this.validateDefault()},removeParam(e,a){e.canRemove&&this.$emit("removeParam",{itemIndex:a}),this.validateDefault()},getAddRemoveClass(e,a){return e.valid?a+1===this.tempDataArr.length?!0:e.canRemove===!0:!1},toggleParam(e,a){if(a+1===this.tempDataArr.length){this.addParam(e,a);return}a+1<this.tempDataArr.length&&this.removeParam(e,a)}},mounted(){this.tempDataArr=this.dataArr,this.theme==="dayHourFromTo"&&this.validateDayAndHours(),this.validateDefault()}},P=e=>(I("data-v-475962f1"),e=e(),C(),e),S={id:"dynamicFilter"},N={key:0,class:"main-wrapper"},R={class:"main-field"},T={key:0,class:"label"},B={key:1,class:"default-error"},q=["onClick","id"],E={key:0,class:"main-wrapper days-main-wrapper"},M={class:"main-field-days-hours"},j={class:"label"},O=P(()=>n("div",{class:"right-arrow-icon-wrapper mask-svg-image gradient"},null,-1)),z={class:"from-to-field-wrapper",id:"from-field-wrapper"},L={class:"label"},W={class:"from-to-field-wrapper",id:"to-field-wrapper"},G=["onClick","id"],J={key:0,class:"delete-row"},K=["onClick"],Q={class:"sub-field"},X={class:"label"};function Y(e,a,t,Z,y,s){const f=H("select-box");return d(),i("div",S,[(d(!0),i(D,null,A(y.tempDataArr,(l,r)=>(d(),i(D,null,[t.theme==="default"?(d(),i("div",N,[n("div",R,[t.mainFieldData?(d(),i("div",T,v(t.mainFieldData.title),1)):u("",!0),(d(),V(x(l.is),w({onInput:o=>s.updateDataArrDefault({type:"default",index:r,val:o.target.value,item:l}),"onUpdate:modelValue":o=>s.updateDataArrDefault({type:"default",index:r,val:o.target.value,item:l})},l),null,16,["onInput","onUpdate:modelValue"])),l.errorMsg?(d(),i("div",B,v(l.errorMsg),1)):u("",!0)]),n("div",{class:c([[s.getAddRemoveClass(l,r)?"enabledAddDay":"disabledAddDay"],"mask-svg-image primary add-remove-default-icon"]),onClick:o=>s.toggleParam(l,r),id:"target"+r,style:p([{"--imgSrc":`url(/img/blue/${r+1===y.tempDataArr.length?"collapsed":"expaned"}.svg`}])},null,14,q)])):u("",!0)],64))),256)),(d(!0),i(D,null,A(y.tempDataArr,(l,r)=>(d(),i(D,null,[t.theme==="dayHourFromTo"?(d(),i("div",E,[n("div",M,[n("div",j,v(t.mainFieldData.title),1),g(f,{options:t.mainFieldData.options,modelValue:l[t.mainFieldData.key],returnIdsArray:"",disabled:l.disabled,single:t.mainFieldData.single?t.mainFieldData.single:!1,"sort-key":null,customPlaceholder:"Select","onUpdate:modelValue":o=>s.updateDataArrDaysAndHours({type:"updateDay",index:r,val:o,item:l})},null,8,["options","modelValue","disabled","single","onUpdate:modelValue"])]),O,(d(!0),i(D,null,A(l[t.subFieldData.key],(o,h)=>(d(),i("div",{class:c(["sub-field",{"m-height":s.divHeight(r)}])},[n("div",z,[n("div",L,v(t.subFieldData.title),1),g(f,{options:t.subFieldData.options.from,modelValue:o.from,returnIdsArray:"","sort-key":null,single:"",disabled:l[t.mainFieldData.key].length===0||l.disabled,"onUpdate:modelValue":m=>s.updateDataArrDaysAndHours({type:"updateFromHour",index:r,hourIndex:h,val:m,item:l})},null,8,["options","modelValue","disabled","onUpdate:modelValue"])]),l[t.mainFieldData.key].length?(d(),i("div",{key:0,class:c(["range-span",[{disabled:l[t.mainFieldData.key].length===0}]])},"-",2)):u("",!0),n("div",W,[g(f,{options:t.subFieldData.options.to,modelValue:o.to,returnIdsArray:"","sort-key":null,single:"",disabled:l[t.mainFieldData.key].length===0||l.disabled,"onUpdate:modelValue":m=>s.updateDataArrDaysAndHours({type:"updateToHour",index:r,hourIndex:h,val:m,item:l})},null,8,["options","modelValue","disabled","onUpdate:modelValue"])]),t.displayAddHours?(d(),i("div",{key:1,class:c([[l.valid||h+1!=l[t.subFieldData.key].length?"enabledAddDay":"disabledAddDay"],"mask-svg-image primary add-remove-hour-icon"]),onClick:m=>s.toggleHours(l,r,h),id:"target"+r,style:p([{"--imgSrc":`url(/img/blue/${h+1===l[t.subFieldData.key].length?"collapsed":"expaned"}.svg`}])},null,14,G)):u("",!0)],2))),256)),t.theme==="dayHourFromTo"?(d(),i("div",J,[n("p",{onClick:o=>s.deleteRow(r)},"Delete Row",8,K)])):(d(!0),i(D,{key:1},A(l[t.subFieldData.key],(o,h)=>(d(),i("div",Q,[n("div",X,v(t.subFieldData.title),1),g(f,{options:t.subFieldData.options,modelValue:o,returnIdsArray:"","sort-key":null,single:"","onUpdate:modelValue":m=>s.updateDataArrDaysAndHours(m,l)},null,8,["options","modelValue","onUpdate:modelValue"])]))),256)),l.error?(d(),i("div",{key:2,class:c(["error",{"error-add-margin":s.divHeight(r)}])},"Make sure you filled the day and hours correctly",2)):u("",!0)])):u("",!0)],64))),256)),t.theme==="dayHourFromTo"?(d(),i("div",{key:0,class:c(["defaultAddDay",y.isValidAddDays?"enabledAddDay":"disabledAddDay"])},[n("p",{onClick:a[0]||(a[0]=l=>s.addDay())},"Add Day")],2)):u("",!0)])}const ee=_(U,[["render",Y],["__scopeId","data-v-475962f1"]]);export{ee as D};
