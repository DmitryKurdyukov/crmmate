import{b as e,e as t,m as i,p as s,i as l,a5 as o,M as n,N as r,f as a,t as c,j as h,F as u,k as d,g as p,b0 as f,a_ as m,a3 as g,A as v,C as b,bn as y,br as w,d as S,v as x,J as C,I as T,l as k,q as L}from"./@vue-DvSXG8OY.js";import{d as F}from"./vuedraggable-DrPHqiy-.js";import{Z as B}from"./@vuepic-D_ESaDHD.js";import{r as M,u as $,w as z}from"./xlsx-BwpPSLqB.js";const E=(e,t)=>{const i=e.__vccOpts||e;for(const[s,l]of t)i[s]=l;return i},V={props:{modelValue:{type:String,default:""},interactive:{type:Boolean,default:!1}},data:()=>({uid:"",table:null,cell:null,row:null,colPos:0,rect:null}),computed:{listeners(){return{...this.$attrs,input:this.onInput}},err(){return this.validate?this.validate(this.modelValue):""},filterRowTop:()=>({})},watch:{modelValue(e){e!==this.$el.textContent&&(this.$refs.cell.textContent=e)}},mounted(){this.uid="uid"+this._uid,this.cell=this.$refs.cell,this.cell.textContent=this.modelValue,this.row=this.cell.parentNode,this.thead=this.row.parentNode,this.colPos=Array.from(this.row.children).indexOf(this.cell)-1,this.colLabel=this.thead.children[0].children[this.colPos+1]},methods:{updateValue(e){const t=e.target.textContent;this.modelValue!==t&&this.$emit("update:modelValue",t)},onInput(e){this.interactive&&this.updateValue(e)},onFocus(){setTimeout((()=>{this.colLabel.classList.add("focus"),this.selectAll(this.cell),this.$parent.currentColPos=this.colPos,this.$parent.currentRowPos=-1,this.$parent.labelTr.children[this.$parent.currentColPos+1].classList.add("focus")}),0)},selectAll(e){const t=window.getSelection();if(t){const i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)}},onBlur(e){this.updateValue(e),this.colLabel.classList.remove("focus"),e.target.classList.remove("edit")},keyWest(e){const t=document.getSelection();if(e.target.textContent===t.toString()||0===t.focusOffset){let t=e.target.previousElementSibling;for(;t&&t.style&&"none"===t.style.display;)t=t.previousElementSibling;return t?(t.focus&&t.focus(),t):t}return e.target},keyEast(e){const t=document.getSelection();if(e.target.textContent===t.toString()||t.focusOffset>=e.target.textContent.length){let t=e.target.nextElementSibling;for(;t&&t.style&&"none"===t.style.display;)t=t.nextElementSibling;return t?(t.focus&&t.focus(),t):t}return e.target},keyEnter(e){e.preventDefault(),this.selectAll(this.cell),this.updateValue(e)},keyDelete(e){""===e.target.textContent&&setTimeout(this.updateValue(e),0)},mouseMove(e){this.cell.style.cursor=this.cell.offsetWidth-e.offsetX<15?"pointer":"text"},mouseDown(e){0===e.button&&this.cell.offsetWidth-e.offsetX<15&&(e.preventDefault(),setTimeout((()=>{this.$parent.$refs.panelFilter.showPanel(this)}),0))}}},P=["id"];const R=E(V,[["render",function(n,r,a,c,h,u){return e(),t("td",i({id:h.uid,ref:"cell",contenteditable:"",ondragenter:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",ondragover:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",class:"cell column-filter",style:u.filterRowTop,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",tabindex:"-1"},o(u.listeners,!0),{onFocus:r[0]||(r[0]=(...e)=>u.onFocus&&u.onFocus(...e)),onBlur:r[1]||(r[1]=(...e)=>u.onBlur&&u.onBlur(...e)),onKeydown:[r[2]||(r[2]=s(l(((...e)=>u.keyWest&&u.keyWest(...e)),["exact"]),["left"])),r[3]||(r[3]=s(l(((...e)=>u.keyEast&&u.keyEast(...e)),["exact"]),["right"])),r[4]||(r[4]=s(l(((...e)=>u.keyEnter&&u.keyEnter(...e)),["exact"]),["enter"]))],onKeyup:r[5]||(r[5]=s(l(((...e)=>u.keyDelete&&u.keyDelete(...e)),["exact"]),["delete"])),onMousemove:r[6]||(r[6]=(...e)=>u.mouseMove&&u.mouseMove(...e)),onMousedown:r[7]||(r[7]=(...e)=>u.mouseDown&&u.mouseDown(...e))}),null,16,P)}],["__scopeId","data-v-c6b23d37"]]),D={props:{nFilterCount:{type:Number,default:1e3},localizedLabel:{type:Object,default:()=>({sortingAndFiltering:"Sorting And Filtering",sortAscending:"Sort Ascending",sortDescending:"Sort Descending",near:"≒ Near",exactMatch:"= Exact Match",notMatch:"≠ Not Match",greaterThan:"&gt; Greater Than",greaterThanOrEqualTo:"≥ Greater Than or Equal To",lessThan:"&lt; Less Than",lessThanOrEqualTo:"≤ Less Than Or Equal To",regularExpression:"~ Regular Expression",customFilter:"Custom Filter",listFirstNValuesOnly:e=>`List first ${e} values only`,apply:"Apply"})}},data:()=>({show:!1,showDropdown:!1,processing:!1,columnFilterRef:null,inputFilter:"",inputFilterCondition:"",sortedUniqueValueList:[]}),computed:{filteredSortedUniqueValueList(){const e=this.inputFilter.toUpperCase();return this.sortedUniqueValueList.filter((t=>t.toUpperCase().startsWith(e)))},symbol(){switch(this.inputFilterCondition){case"":return"≒";case"<=":return"≤";case">=":return"≥";case"<>":return"≠";default:return this.inputFilterCondition}}},methods:{clickOutside(e){"panelModal"===e.target.id&&this.hidePanel()},sort(e){this.hidePanel(),this.$parent.sort(e,this.columnFilterRef.colPos)},setFilterCondition(e){this.showDropdown=!1,this.inputFilterCondition=e,this.$refs.inputFilter.focus()},freezePanelSizeAfterShown(){const e=this.$refs.panelList,t=e.getBoundingClientRect();e.setAttribute("style",`width:${t.width}px; height:${t.height}px;`)},removePanelSizeAfterHide(){this.$refs.panelList.removeAttribute("style")},doInputFilter(){window.delay&&clearTimeout(window.delay),window.delay=setTimeout((()=>{this.inputFilter=this.$refs.inputFilter.value}),200)},doFilter(){const e=this.inputFilterCondition+this.$refs.inputFilter.value;this.columnFilterRef.$el.textContent=e,this.columnFilterRef.$emit("update:modelValue",e),this.hidePanel()},filterPanelSelect(e){this.columnFilterRef.$el.textContent="="+e,this.columnFilterRef.$emit("update:modelValue","="+e),this.hidePanel()},showPanel(e){this.columnFilterRef=e,this.inputFilter="",this.inputFilterCondition="",this.sortedUniqueValueList=[],this.$refs.inputFilter.value="",""!=this.columnFilterRef.$el.textContent&&(this.columnFilterRef.$el.textContent="",this.columnFilterRef.$emit("update:modelValue",""),this.$parent.calTable()),setTimeout((()=>{this.show=!0,setTimeout((()=>this.$refs.inputFilter.focus()));const t={},i=this.$parent.fields[e.colPos].name;this.$parent.table.forEach((e=>t[e[i]]=!0));const s=Object.keys(t);s.sort(),s.length>0&&""===s[0]&&(s[0]=" "),this.sortedUniqueValueList=s,setTimeout((()=>this.freezePanelSizeAfterShown()))}))},hidePanel(){this.show=!1,this.removePanelSizeAfterHide(),setTimeout((()=>{this.sortedUniqueValueList=[]}),0)}}},H=e=>(f("data-v-f33bd485"),e=e(),m(),e),O={ref:"panelFilter",class:"panel-body"},A={class:"panel-title"},I=H((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-amount-down",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-sort-amount-down fa-w-16 fa-1x"},[a("path",{fill:"currentColor",d:"M304 416h-64a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-128-64h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.37 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm256-192H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h192a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-64 128H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM496 32H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h256a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z",class:""})],-1))),N=["innerHTML"],W={class:"panel-content"},U={class:"panel-action"},q=H((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-alpha-down",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"svg-inline--fa fa-sort-alpha-down fa-w-14"},[a("path",{fill:"currentColor",d:"M176 352h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm240-64H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 446.37V464a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 321.63V304a16 16 0 0 0-16-16zm31.06-85.38l-59.27-160A16 16 0 0 0 372.72 32h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 224h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 224H432a16 16 0 0 0 15.06-21.38zM335.61 144L352 96l16.39 48z",class:""})],-1))),j=["innerHTML"],K=H((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-alpha-up-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"svg-inline--fa fa-sort-alpha-up-alt fa-w-14"},[a("path",{fill:"currentColor",d:"M16 160h48v304a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16V160h48c14.21 0 21.38-17.24 11.31-27.31l-80-96a16 16 0 0 0-22.62 0l-80 96C-5.35 142.74 1.78 160 16 160zm272 64h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 65.63V48a16 16 0 0 0-16-16H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 190.37V208a16 16 0 0 0 16 16zm159.06 234.62l-59.27-160A16 16 0 0 0 372.72 288h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 480h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 480H432a16 16 0 0 0 15.06-21.38zM335.61 400L352 352l16.39 48z",class:""})],-1))),_=["innerHTML"],X={class:"panel-action"},Y=["innerHTML"],J=["innerHTML"],G=["innerHTML"],Z=["innerHTML"],Q=["innerHTML"],ee=["innerHTML"],te=["innerHTML"],ie=["innerHTML"],se={class:"panel-input-b"},le=["placeholder"],oe={ref:"panelList",class:"panel-list"},ne=["onClick"],re=H((()=>a("input",{type:"checkbox",class:"panel-checkbox"},null,-1))),ae={key:0,class:"normal-text",style:{float:"right"}},ce=["innerHTML"],he={class:"panel-footer"},ue=H((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sign-in-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-sign-in-alt fa-w-16 fa-fw fa-sm"},[a("path",{fill:"currentColor",d:"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z",class:""})],-1))),de=["innerHTML"];const pe=E(D,[["render",function(i,o,f,m,g,v){return n((e(),t("div",{id:"panelModal",class:"panel-modal",onClick:o[14]||(o[14]=(...e)=>v.clickOutside&&v.clickOutside(...e)),onKeydown:o[15]||(o[15]=s(l(((...e)=>v.hidePanel&&v.hidePanel(...e)),["exact"]),["esc"]))},[a("div",O,[a("div",A,[I,a("span",{innerHTML:f.localizedLabel.sortingAndFiltering},null,8,N)]),a("div",W,[a("div",U,[a("button",{class:"panel-button float-left",onClick:o[0]||(o[0]=e=>v.sort(1))},[q,a("span",{innerHTML:f.localizedLabel.sortAscending},null,8,j)]),a("button",{class:"panel-button float-right",onClick:o[1]||(o[1]=e=>v.sort(-1))},[K,a("span",{innerHTML:f.localizedLabel.sortDescending},null,8,_)])]),a("div",X,[a("div",null,[a("button",{class:"panel-input-button",onClick:o[2]||(o[2]=e=>g.showDropdown=!g.showDropdown)},c(v.symbol),1),a("div",{class:h([{show:g.showDropdown},"panel-dropdown"])},[a("div",{class:"panel-dropdown-item",onClick:o[3]||(o[3]=l((e=>v.setFilterCondition("")),["prevent"]))},[a("span",{innerHTML:f.localizedLabel.near},null,8,Y)]),a("div",{class:"panel-dropdown-item",onClick:o[4]||(o[4]=l((e=>v.setFilterCondition("=")),["prevent"]))},[a("span",{innerHTML:f.localizedLabel.exactMatch},null,8,J)]),a("div",{class:"panel-dropdown-item",onClick:o[5]||(o[5]=l((e=>v.setFilterCondition("<>")),["prevent"]))},[a("span",{innerHTML:f.localizedLabel.notMatch},null,8,G)]),a("div",{class:"panel-dropdown-item",onClick:o[6]||(o[6]=l((e=>v.setFilterCondition(">")),["prevent"]))},[a("span",{innerHTML:f.localizedLabel.greaterThan},null,8,Z)]),a("div",{class:"panel-dropdown-item",onClick:o[7]||(o[7]=l((e=>v.setFilterCondition(">=")),["prevent"]))},[a("span",{innerHTML:f.localizedLabel.greaterThanOrEqualTo},null,8,Q)]),a("div",{class:"panel-dropdown-item",onClick:o[8]||(o[8]=l((e=>v.setFilterCondition("<")),["prevent"]))},[a("span",{innerHTML:f.localizedLabel.lessThan},null,8,ee)]),a("div",{class:"panel-dropdown-item",onClick:o[9]||(o[9]=l((e=>v.setFilterCondition("<=")),["prevent"]))},[a("span",{innerHTML:f.localizedLabel.lessThanOrEqualTo},null,8,te)]),a("div",{class:"panel-dropdown-item",onClick:o[10]||(o[10]=l((e=>v.setFilterCondition("~")),["prevent"]))},[a("span",{innerHTML:f.localizedLabel.regularExpression},null,8,ie)])],2),a("span",se,[a("input",{type:"text",ref:"inputFilter",class:"panel-input",placeholder:f.localizedLabel.customFilter,trim:"",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",onKeyup:o[11]||(o[11]=(...e)=>v.doInputFilter&&v.doInputFilter(...e)),onKeydown:o[12]||(o[12]=s(l(((...e)=>v.doFilter&&v.doFilter(...e)),["exact"]),["enter"]))},null,40,le)])])]),a("div",null,[a("div",oe,[(e(!0),t(u,null,d(v.filteredSortedUniqueValueList.slice(0,f.nFilterCount),((i,s)=>(e(),t("div",{key:s,class:"panel-list-item",onClick:l((e=>v.filterPanelSelect(i)),["prevent"])},[re,a("span",null,c(i),1)],8,ne)))),128))],512),v.filteredSortedUniqueValueList.length>f.nFilterCount?(e(),t("div",ae,[a("span",{innerHTML:f.localizedLabel.listFirstNValuesOnly(f.nFilterCount)},null,8,ce)])):p("",!0)])]),a("div",he,[a("button",{class:"panel-button",onClick:o[13]||(o[13]=(...e)=>v.doFilter&&v.doFilter(...e))},[ue,a("span",{innerHTML:f.localizedLabel.apply},null,8,de)])])],512)],544)),[[r,g.show]])}],["__scopeId","data-v-f33bd485"]]),fe={components:{draggable:F},props:{modelValue:Array,localizedLabel:{type:Object,default:()=>({tableSetting:"Table Setting",exportExcel:"Export Excel",importExcel:"Import Excel",back:"Back",reset:"Default"})}},data:()=>({show:!1,processing:!1}),computed:{fields:{get:function(){return this.modelValue},set:function(e){this.$emit("update:modelValue",e)}}},methods:{reset(){this.$parent.resetColumn(),this.hidePanel()},clickOutside(e){"panelModal"===e.target.id&&this.hidePanel()},columnLabelClick(e,t){t.invisible=!t.invisible,setTimeout(this.$parent.calStickyLeft)},freezePanelSizeAfterShown(){const e=this.$refs.panelList,t=e.getBoundingClientRect();e.setAttribute("style",`width:${t.width}px; height:${t.height}px;`)},removePanelSizeAfterHide(){this.$refs.panelList.removeAttribute("style")},exportTable(e){this.hidePanel(),this.$parent.exportTable(e)},importTable(){this.hidePanel(),this.$parent.importTable()},showPanel(){this.show=!0,setTimeout((()=>this.$refs.button.focus())),setTimeout((()=>this.freezePanelSizeAfterShown()))},hidePanel(){this.show=!1,this.removePanelSizeAfterHide()}}},me=e=>(f("data-v-2b08b7d2"),e=e(),m(),e),ge={ref:"panelSetting",class:"panel-body"},ve={class:"panel-title"},be=me((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"bars",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"svg-inline--fa fa-bars fa-w-14 fa-1x"},[a("path",{fill:"currentColor",d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z",class:""})],-1))),ye=["innerHTML"],we={class:"panel-content"},Se={class:"panel-action"},xe=me((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"file-excel",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",class:"svg-inline--fa fa-file-excel fa-w-12"},[a("path",{fill:"currentColor",d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z",class:""})],-1))),Ce=["innerHTML"],Te=me((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"file-csv",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",class:"svg-inline--fa fa-file-csv fa-w-12"},[a("path",{fill:"currentColor",d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm-96 144c0 4.42-3.58 8-8 8h-8c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h8c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-8c-26.51 0-48-21.49-48-48v-32c0-26.51 21.49-48 48-48h8c4.42 0 8 3.58 8 8v16zm44.27 104H160c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h12.27c5.95 0 10.41-3.5 10.41-6.62 0-1.3-.75-2.66-2.12-3.84l-21.89-18.77c-8.47-7.22-13.33-17.48-13.33-28.14 0-21.3 19.02-38.62 42.41-38.62H200c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-12.27c-5.95 0-10.41 3.5-10.41 6.62 0 1.3.75 2.66 2.12 3.84l21.89 18.77c8.47 7.22 13.33 17.48 13.33 28.14.01 21.29-19 38.62-42.39 38.62zM256 264v20.8c0 20.27 5.7 40.17 16 56.88 10.3-16.7 16-36.61 16-56.88V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v20.8c0 35.48-12.88 68.89-36.28 94.09-3.02 3.25-7.27 5.11-11.72 5.11s-8.7-1.86-11.72-5.11c-23.4-25.2-36.28-58.61-36.28-94.09V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8zm121-159L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z",class:""})],-1))),ke=["innerHTML"],Le={ref:"panelList",class:"panel-list"},Fe=["onClick"],Be=["onUpdate:modelValue"],Me={class:"panel-footer"},$e=me((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"save",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"svg-inline--fa fa-save fa-w-14 fa-fw fa-sm"},[a("path",{fill:"currentColor",d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z",class:""})],-1))),ze=["innerHTML"],Ee=me((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sign-in-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-sign-in-alt fa-w-16 fa-fw fa-sm"},[a("path",{fill:"currentColor",d:"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z",class:""})],-1))),Ve=["innerHTML"];const Pe=E(fe,[["render",function(i,o,h,u,d,p){const f=g("draggable");return n((e(),t("div",{id:"panelModal",class:"panel-modal",onClick:o[5]||(o[5]=(...e)=>p.clickOutside&&p.clickOutside(...e)),onKeydown:o[6]||(o[6]=s(l(((...e)=>p.hidePanel&&p.hidePanel(...e)),["exact"]),["esc"]))},[a("div",ge,[a("div",ve,[be,a("span",{innerHTML:h.localizedLabel.tableSetting},null,8,ye)]),a("div",we,[a("div",Se,[a("button",{class:"panel-button float-left no-margin",onClick:o[0]||(o[0]=e=>p.exportTable("excel"))},[xe,a("span",{innerHTML:h.localizedLabel.exportExcel},null,8,Ce)]),a("button",{class:"panel-button float-right no-margin",onClick:o[1]||(o[1]=(...e)=>p.importTable&&p.importTable(...e))},[Te,a("span",{innerHTML:h.localizedLabel.importExcel},null,8,ke)])]),a("div",null,[a("div",Le,[v(f,{modelValue:p.fields,"onUpdate:modelValue":o[2]||(o[2]=e=>p.fields=e),draggable:".panel-list-item","item-key":"fields"},{item:b((({element:e})=>[a("div",{class:"panel-list-item",onClick:l((t=>p.columnLabelClick(t,e)),["prevent"])},[n(a("input",{type:"checkbox","onUpdate:modelValue":t=>e.invisible=t,class:"panel-checkbox","true-value":!1,"false-value":!0},null,8,Be),[[y,e.invisible]]),a("span",null,c(e.label),1)],8,Fe)])),_:1},8,["modelValue"])],512)])]),a("div",Me,[a("button",{ref:"button",class:"panel-button",onClick:o[3]||(o[3]=(...e)=>p.reset&&p.reset(...e))},[$e,a("span",{innerHTML:h.localizedLabel.reset},null,8,ze)],512),a("button",{ref:"button",class:"panel-button",onClick:o[4]||(o[4]=(...e)=>p.hidePanel&&p.hidePanel(...e))},[Ee,a("span",{innerHTML:h.localizedLabel.back},null,8,Ve)],512)])],512)],544)),[[r,d.show]])}],["__scopeId","data-v-2b08b7d2"]]),Re={props:{localizedLabel:{type:Object,default:()=>({})}},data:()=>({show:!1,processing:!1,inputFind:""}),methods:{clickOutside(e){"panelModal"===e.target.id&&this.hidePanel()},doFind(e,t){t&&t.preventDefault(),this.hidePanel(),this.$parent.doFind(this.inputFind)},showPanel(){this.show=!0,setTimeout((()=>this.$refs.inputFind.focus()))},hidePanel(){this.show=!1}}},De={ref:"panelFind",class:"panel-body"},He={class:"panel-input-b"},Oe=[(e=>(f("data-v-c6af5a9e"),e=e(),m(),e))((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"search",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-search fa-w-16 fa-sm"},[a("path",{fill:"currentColor",d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z",class:""})],-1)))];const Ae=S({components:{"vue-excel-filter":R,"panel-filter":pe,"panel-setting":Pe,"panel-find":E(Re,[["render",function(i,o,c,h,u,d){return n((e(),t("div",{id:"panelModal",class:"panel-modal",onClick:o[3]||(o[3]=(...e)=>d.clickOutside&&d.clickOutside(...e)),onKeydown:o[4]||(o[4]=s(l(((...e)=>d.hidePanel&&d.hidePanel(...e)),["exact"]),["esc"]))},[a("div",De,[a("div",null,[a("span",He,[n(a("input",{type:"text",ref:"inputFind","onUpdate:modelValue":o[0]||(o[0]=e=>u.inputFind=e),class:"panel-input",trim:"",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",onKeydown:o[1]||(o[1]=s(l((e=>d.doFind(u.inputFind,e)),["exact"]),["enter"]))},null,544),[[w,u.inputFind]])]),a("button",{class:"panel-input-button",onClick:o[2]||(o[2]=e=>d.doFind(u.inputFind))},Oe)])],512)],544)),[[r,u.show]])}],["__scopeId","data-v-c6af5a9e"]]),"date-picker":B},props:{disablePanelSetting:{type:Boolean,default:()=>!1},disablePanelFilter:{type:Boolean,default:()=>!1},modelValue:{type:Array,default:()=>[]},rowStyle:{type:Function,default:()=>({})},cellStyle:{type:Function,default:()=>({})},headerLabel:{type:Function,default:e=>e},recordLabel:{type:Function,default:e=>e},noFinding:{type:Boolean,default:!1},noFindingNext:{type:Boolean,default:!1},filterRow:{type:Boolean,default:!1},freeSelect:{type:Boolean,default:!1},noFooter:{type:Boolean,default:!1},noPaging:{type:Boolean,default:!1},noNumCol:{type:Boolean,default:!1},noMouseScroll:{type:Boolean,default:!1},page:{type:Number,default:0},enterToSouth:{type:Boolean,default:!1},nFilterCount:{type:Number,default:1e3},height:{type:String,default:""},width:{type:String,default:"100%"},wheelSensitivity:{type:Number,default:30},autocomplete:{type:Boolean,default:!1},autocompleteCount:{type:Number,default:50},readonly:{type:Boolean,default:!1},readonlyStyle:{type:Object,default:()=>({})},remember:{type:Boolean,default:!1},register:{type:Function,default:null},allowAddCol:{type:Boolean,default:!1},noHeaderEdit:{type:Boolean,default:!1},addColumn:{type:Function,default:null},spellcheck:{type:Boolean,default:!1},newIfBottom:{type:Boolean,default:!1},validate:{type:Function,default:null},localizedLabel:{type:Object,default:()=>({footerLeft:(e,t,i)=>`Record ${e} to ${t} of ${i}`,first:"First",previous:"Previous",next:"Next",last:"Last",footerRight:{selected:"Selected:",filtered:"Filtered:",loaded:"Loaded:"},processing:"Processing",tableSetting:"Table Setting",exportExcel:"Export Excel",importExcel:"Import Excel",back:"Back",reset:"Default",sortingAndFiltering:"Sorting And Filtering",sortAscending:"Sort Ascending",sortDescending:"Sort Descending",near:"≒ Near",exactMatch:"= Exact Match",notMatch:"≠ Not Match",greaterThan:"&gt; Greater Than",greaterThanOrEqualTo:"≥ Greater Than or Equal To",lessThan:"&lt; Less Than",lessThanOrEqualTo:"≤ Less Than Or Equal To",regularExpression:"~ Regular Expression",customFilter:"Custom Filter",listFirstNValuesOnly:e=>`List first ${e} values only`,apply:"Apply",noRecordIsRead:"No record is read",readonlyColumnDetected:"Readonly column detected",columnHasValidationError:(e,t)=>`Column ${e} has validation error: ${t}`,rowHasValidationError:(e,t,i)=>`Row ${e} has validation error for column ${t}: ${i}`,noMatchedColumnName:"No matched column name",invalidInputValue:"Invalid input value",missingKeyColumn:"Missing key column",noRecordIndicator:"No record"})},recordFilter:{type:Function,default:()=>!0}},data(){return{version:"1.3",tableContent:null,systable:null,colgroupTr:null,labelTr:null,filterTr:null,recordBody:null,footer:null,pageSize:this.noPaging?999999:20,pageTop:0,selected:{},selectedCount:0,prevSelect:-1,processing:!1,rowIndex:{},currentRecord:null,currentRowPos:0,currentColPos:0,currentField:null,currentCell:null,inputBox:null,inputBoxShow:0,inputSquare:null,autocompleteInputs:[],autocompleteSelect:-1,errmsg:{},rowerr:{},tip:"",colHash:"",fields:[],focused:!1,mousein:!1,inputBoxChanged:!1,columnFilter:{},inputFind:"",calCellLeft:0,calCellTop:0,calCellTop2:29,frontdrop:null,sortPos:0,sortDir:0,redo:[],lazyTimeout:{},lazyBuffer:{},hScroller:{},vScroller:{},leftMost:0,showDatePicker:!1,inputDateTime:new Date,table:[],filteredValue:[],lastFilterTime:"",summaryRow:!1,summary:{},showFilteredOnly:!0,showSelectedOnly:!1}},computed:{token(){return`vue-excel-editor-${Array.from(document.querySelectorAll(".vue-excel-editor")).indexOf(this.$el)}`},columnFilterString(){return Object.keys(this.columnFilter).forEach((e=>{""===this.columnFilter[e].trim()&&delete this.columnFilter[e]})),JSON.stringify(this.columnFilter)},pagingTable(){return this.table.slice(this.pageTop,this.pageTop+this.pageSize)},pageBottom(){return 0===this.filteredValue.length?0:this.pageTop+this.pageSize>this.table.length?this.table.length:this.pageTop+this.pageSize},setting:{get:()=>null,set(e){if(e.fields){if(e.fields.length!==this.fields.length)return;let t=!0;const i=e.fields.map((e=>{const i=this.fields.find((t=>t.name===e.name));return i?(void 0!==e.invisible&&(i.invisible=e.invisible),void 0!==e.width&&(i.width=e.width),void 0!==e.label&&(i.label=e.label)):t=!1,i}));if(t){this.fields=i;const e=x();e?.proxy?.$forceUpdate()}}}}},watch:{modelValue(){this.lazy((()=>{this.refresh(),this.pageTop>this.table.length&&this.lastPage()}))},columnFilterString(){this.lastFilterTime=String((new Date).getTime()%1e8),this.processing=!0,setTimeout((()=>{this.pageTop=0,this.refresh(),this.processing=!1}),0)},fields:{handler(){this.lazy((()=>{const e=this.getSetting();this.remember&&(localStorage[window.location.pathname+"."+this.token]=JSON.stringify(e)),this.$emit("setting",e)}))},deep:!0},processing(e){if(e){const e=this.$el.children[0].getBoundingClientRect();this.frontdrop.style.top=e.top+"px",this.frontdrop.style.left=e.left+"px",this.frontdrop.style.height=e.height+"px",this.frontdrop.style.width=e.width+"px"}},pageTop(e){this.$emit("page-changed",e,e+this.pageSize-1)},pageSize(e){this.$emit("page-changed",this.pageTop,this.pageTop+e-1)}},beforeUnmount(){window.removeEventListener("resize",this.winResize),window.removeEventListener("paste",this.winPaste),window.removeEventListener("keydown",this.winKeydown),window.removeEventListener("keyup",this.winKeyup),window.removeEventListener("scroll",this.winScroll),window.removeEventListener("wheel",this.mousewheel)},mounted(){if(this.editor=this.$refs.editor,this.tableContent=this.$refs.tableContent,this.systable=this.$refs.systable,this.colgroupTr=this.systable.children[0],this.labelTr=this.systable.children[1].children[0],this.filterTr=this.systable.children[1].children[1],this.recordBody=this.systable.children[2],this.footer=this.$refs.footer,this.inputSquare=this.$refs.inputSquare,this.inputBox=this.$refs.inputBox,this.frontdrop=this.$refs.frontdrop,this.height&&(this.systable.parentNode.style.height=this.height),this.reset(),this.lazy((()=>{this.labelTr.children[0].style.height=this.labelTr.offsetHeight+"px",this.calCellTop2=this.labelTr.offsetHeight,this.refreshPageSize(),this.tableContent.scrollTo(0,this.tableContent.scrollTop),this.calStickyLeft()}),200),ResizeObserver&&new ResizeObserver(this.winResize).observe(this.tableContent),window.addEventListener("resize",this.winResize),window.addEventListener("paste",this.winPaste),window.addEventListener("keydown",this.winKeydown),window.addEventListener("keyup",this.winKeyup),window.addEventListener("scroll",this.winScroll),window.addEventListener("wheel",this.mousewheel,{passive:!1}),this.remember){const e=localStorage[window.location.pathname+"."+this.token];if(e){const t=JSON.parse(e);t.colHash===this.colHash&&(this.setting=t)}}},methods:{componentTabInto(e){9===e.keyCode&&(this.moveInputSquare(this.currentRowPos,this.currentColPos)||this.moveInputSquare(0,0))},reset(){this.errmsg={},this.redo=[],this.showFilteredOnly=!0,this.showSelectedOnly=!1,this.columnFilter={},this.sortPos=0,this.sortDir=0,this.inputFind="",this.pageTop=0,this.selected={},this.selectedCount=0,this.prevSelect=-1,this.processing=!1,this.rowIndex={},this.refresh()},toggleSelectView(e){return e&&e.stopPropagation(),this.showSelectedOnly=!this.showSelectedOnly,this.refresh()},toggleFilterView(e){return e&&e.stopPropagation(),this.showFilteredOnly=!this.showFilteredOnly,this.refresh()},resetColumn(){this.fields=[],this.tableContent.scrollTo(0,this.tableContent.scrollTop),this.calStickyLeft()},registerColumn(e){let t=this.fields.findIndex((t=>t.pos>e.pos));-1===t&&(t=this.fields.length),this.fields.splice(t,0,e),this.register&&this.register(e,t),e.register&&e.register(e,t),e.summary&&(this.summaryRow=!0),this.colHash=this.hashCode(this.version+JSON.stringify(this.fields))},insertColumn(e){const t="COL-"+Math.random().toString().slice(2,6);let i={name:t,label:t,type:"string",width:"100px",validate:null,change:null,link:null,sort:null,keyField:!1,sticky:!1,allowKeys:null,mandatory:!1,lengthLimit:0,autocomplete:this.autocomplete,textTransform:null,initStyle:"left",invisible:!1,readonly:this.readonly,pos:0,options:null,summary:null,toValue:e=>e,toText:e=>e,register:null};this.addColumn&&(i=this.addColumn(i)),this.newColumn(i,e)},newColumn(e,t){this.fields.splice(t,0,e),this.register&&this.register(e,t),e.register&&e.register(e,t),e.summary&&(this.summaryRow=!0),this.colHash=this.hashCode(this.version+JSON.stringify(this.fields))},autoRegisterAllColumns(e){const t=e.slice(0,25).reduce(((e,t)=>Object.keys(t).map(((i,s)=>!e||t[i].length>e[s]?t[i].length:e[s]))),0).map((e=>Math.min(Math.max(8.2*e,55),250)));Object.keys(e[0]).forEach(((e,i)=>{"$id"!==e&&this.registerColumn({name:e,label:e,type:t[i]?"string":"number",width:(t[i]?t[i]:75)+"px",validate:null,change:null,link:null,keyField:!1,sticky:!1,tabStop:!0,allowKeys:null,mandatory:!1,lengthLimit:0,autocomplete:this.autocomplete,initStyle:{textAlign:t[i]?"left":"right"},invisible:!1,readonly:this.readonly,pos:0,options:null,summary:null,sort:null,toValue:e=>e,toText:e=>e,register:null})}))},refresh(){this.prevSelect=-1,0===this.fields.length&&this.modelValue.length&&Object.keys(this.modelValue[0])&&this.autoRegisterAllColumns(this.modelValue),this.calTable(),this.calStickyLeft(),this.refreshPageSize()},calTable(){let e=String((new Date).getTime()%1e8);if(this.modelValue.forEach(((t,i)=>{t.$id||(t.$id=e+"-"+("000000"+i).slice(-7))})),!1===this.showFilteredOnly)this.table=this.modelValue;else{const e=Object.keys(this.columnFilter),t={};e.forEach((e=>{switch(!0){case this.columnFilter[e].startsWith("<="):t[e]={type:1,modelValue:this.columnFilter[e].slice(2).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].modelValue=Number(t[e].modelValue));break;case this.columnFilter[e].startsWith("<>"):t[e]={type:9,modelValue:this.columnFilter[e].slice(2).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("<"):t[e]={type:2,modelValue:this.columnFilter[e].slice(1).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].modelValue=Number(t[e].modelValue));break;case this.columnFilter[e].startsWith(">="):t[e]={type:3,modelValue:this.columnFilter[e].slice(2).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].modelValue=Number(t[e].modelValue));break;case this.columnFilter[e].startsWith(">"):t[e]={type:4,modelValue:this.columnFilter[e].slice(1).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].modelValue=Number(t[e].modelValue));break;case this.columnFilter[e].startsWith("="):t[e]={type:0,modelValue:this.columnFilter[e].slice(1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("*")&&this.columnFilter[e].endsWith("*"):t[e]={type:5,modelValue:this.columnFilter[e].slice(1).slice(0,-1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("*")&&!this.columnFilter[e].slice(1).includes("*"):t[e]={type:6,modelValue:this.columnFilter[e].slice(1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("~"):t[e]={type:8,modelValue:this.columnFilter[e].slice(1).trim()};break;case this.columnFilter[e].endsWith("*")&&!this.columnFilter[e].slice(0,-1).includes("*"):t[e]={type:7,modelValue:this.columnFilter[e].slice(0,-1).trim().toUpperCase()};break;case this.columnFilter[e].includes("*")||this.columnFilter[e].includes("?"):t[e]={type:8,modelValue:"^"+this.columnFilter[e].replace(/\*/g,".*").replace(/\?/g,".").trim()+"$"};break;default:t[e]={type:5,modelValue:this.columnFilter[e].trim().toUpperCase()}}})),this.filteredValue=this.modelValue.filter((e=>this.recordFilter(e))),0===e.length?this.table=this.filteredValue:this.table=this.filteredValue.filter((i=>{if(i.$id>this.lastFilterTime)return!0;const s={};e.forEach((e=>{const l=i[this.fields[e].name];"number"===this.fields[e].type&&t[e].type<=4?s[e]=l:s[e]=null==l?"":String(l).toUpperCase()}));for(let l=0;l<e.length;l++){const i=e[l];switch(t[i].type){case 0:if(`${s[i]}`!=`${t[i].modelValue}`)return!1;break;case 1:if(t[i].modelValue<s[i])return!1;break;case 2:if(t[i].modelValue<=s[i])return!1;break;case 3:if(t[i].modelValue>s[i])return!1;break;case 4:if(t[i].modelValue>=s[i])return!1;break;case 5:if(!s[i].includes(t[i].modelValue))return!1;break;case 6:if(!s[i].endsWith(t[i].modelValue))return!1;break;case 7:if(!s[i].startsWith(t[i].modelValue))return!1;break;case 8:if(!new RegExp(t[i].modelValue,"i").test(s[i]))return!1;break;case 9:if(`${s[i]}`==`${t[i].modelValue}`)return!1}}return!0}))}this.reviseSelectedAfterTableChange(),this.showSelectedOnly&&(this.table=this.table.filter(((e,t)=>this.selected[t])),this.reviseSelectedAfterTableChange()),this.calSummary()},calStickyLeft(){let e=0,t=0;this.leftMost=-1,Array.from(this.labelTr.children).forEach((i=>{e+=i.offsetWidth;const s=this.fields[t++];s&&(s.sticky?(s.left=e+"px",this.leftMost=-1):-1===this.leftMost&&(this.leftMost=e))}));const i=x();i?.proxy?.$forceUpdate()},renderColumnCellStyle(e){let t=e.initStyle;return e.readonly&&(t=Object.assign(t,this.readonlyStyle)),e.left&&(t=Object.assign(t,{left:e.left})),t},localeDate(e){void 0===e&&(e=new Date);const t=e=>e<10?"0"+e:e;return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())},calSummary(e){this.fields.forEach((t=>{if(!t.summary)return;const i=t.name;if(e&&e!==i)return;let s="";const l=(new Date).getTime(),o=this.localeDate(),n=o.slice(0,19),r=o.slice(0,10);switch(t.summary){case"sum":s=this.table.reduce(((e,t)=>e+Number(t[i]?t[i]:0)),0),s=Number(Math.round(s+"e+5")+"e-5");break;case"avg":s=this.table.reduce(((e,t)=>e+Number(t[i]?t[i]:0)),0)/this.table.length,s=Number(Math.round(s+"e+5")+"e-5");break;case"max":s=this.table.reduce(((e,t)=>e>t[i]?e:t[i]),Number.MIN_VALUE);break;case"min":s=this.table.reduce(((e,t)=>e<t[i]?e:t[i]),Number.MAX_VALUE);break;case"count":switch(t.type){case"checkYN":s=this.table.reduce(((e,t)=>e+("Y"===t[i]?1:0)),0);break;case"check10":s=this.table.reduce(((e,t)=>e+("1"===t[i]?1:0)),0);break;case"checkTF":s=this.table.reduce(((e,t)=>e+("T"===t[i]?1:0)),0);break;case"date":return s=this.table.reduce(((e,t)=>e+(t[i]>=r?1:0)),0),void(this.summary[i]=s);case"datetime":return s=this.table.reduce(((e,t)=>e+(t[i]>=n?1:0)),0),void(this.summary[i]=s);case"datetimesec":return s=this.table.reduce(((e,t)=>e+(t[i]>=o?1:0)),0),void(this.summary[i]=s);case"datetick":case"datetimetick":case"datetimesectick":return s=this.table.reduce(((e,t)=>e+(t[i]>=l?1:0)),0),void(this.summary[i]=s);default:s=this.table.reduce(((e,t)=>e+(t[i]?1:0)),0)}}"number"===t.type&&isNaN(s)||(this.summary[i]=t.toText(s))}))},getKeys(e){e||(e=this.currentRecord);const t=this.fields.filter((e=>e.keyField)).map((t=>e[t.name]));return t.length&&""!==t.join()?t:[e.$id]},getFieldByName(e){return this.fields.find((t=>t.name===e))},getFieldByLabel(e){return this.fields.find((t=>t.label===e))},setFilter(e,t){const i=this.$refs[`filter-${e}`][0];i.$el.textContent=t,i.$emit("update:modelValue",t)},clearFilter(e){e?this.setFilter(e,""):this.columnFilter={}},columnSuppress(){if(0===this.table.length)return;const e={};this.table.forEach((t=>{Object.keys(t).forEach((i=>{t[i]&&(e[i]=1)}))}));const t=Object.keys(e);this.fields.forEach((e=>{t.includes(e.name)||(e.invisible=!0)}))},columnAutoWidth(e){if(0===this.table.length)return;let t=this.fields;e&&(t=[this.fields.find((t=>t.name===e))]);const i={};this.table.forEach((e=>{t.forEach((t=>{e[t.name]&&(!i[t.name]||i[t.name]<e[t.name].length)&&(i[t.name]=e[t.name].length)}))})),t.forEach((e=>{let t=12*i[e.name];t>450&&(t=450),e.width=t+"px"}))},columnFillWidth(){if(0===this.table.length)return;if(!this.editor)return;const e=this.fields.filter((e=>e.autoFillWidth)),t=e.length;if(!t)return;const i=this.editor.getBoundingClientRect().width,s=this.fields.filter((e=>!e.invisible)).reduce(((e,t)=>e- -t.width.replace(/px$/,"")),0)+(this.noNumCol?0:40)-i+2;s&&e.forEach((e=>e.width=e.width.replace(/px$/,"")-s/t+"px"))},showDatePickerDiv(){if(!this.$refs.dpContainer)return;const e=this.currentCell.getBoundingClientRect();this.$refs.dpContainer.style.left=e.left+"px",this.$refs.dpContainer.style.top=e.bottom+"px",this.inputDateTime=new Date(this.currentCell.textContent),this.showDatePicker=!0,this.lazy((()=>{if(!this.$refs.dpContainer)return;const t=this.$refs.dpContainer.getBoundingClientRect();t.bottom>window.innerHeight&&(this.$refs.dpContainer.style.top=e.top-t.height+"px"),t.right>window.innerWidth&&(this.$refs.dpContainer.style.left=window.innerWidth-t.width+"px")}))},datepickerClick(){const e=60*(new Date).getTimezoneOffset()*1e3;switch(this.currentField.type){case"date":this.inputBox.value=new Date(new Date(this.inputDateTime)-e).toISOString().slice(0,10);break;case"datetime":this.inputBox.value=new Date(new Date(this.inputDateTime)-e).toISOString().replace("T"," ").slice(0,16)+":00";break;case"datetimesec":this.inputBox.value=new Date(new Date(this.inputDateTime)-e).toISOString().replace("T"," ").slice(0,19);break;case"datetick":case"datetimetick":case"datetimesectick":this.inputBox.value=new Date(new Date(this.inputDateTime)-e).getTime()}this.inputBoxShow=0,this.inputCellWrite(this.inputBox.value),this.showDatePicker=!1,this.focused=!0},calVScroll(){let e=this.labelTr.getBoundingClientRect().height;this.filterRow&&(e+=29),this.vScroller.top=e,this.noFooter||(e+=25),this.summaryRow&&(e+=27);const t=this.$el.getBoundingClientRect().height;this.vScroller.height=t-e;const i=this.vScroller.height/(24*this.table.length);this.vScroller.buttonHeight=Math.max(24,this.vScroller.height*i);const s=(this.tableContent.scrollTop+24*this.pageTop)/(24*this.table.length-this.vScroller.height);this.vScroller.buttonTop=(this.vScroller.height-this.vScroller.buttonHeight)*s;const l=x();l?.proxy?.$forceUpdate()},vsMouseDown(e){e.stopPropagation();const t=e.offsetY-this.vScroller.buttonHeight/2;let i=Math.max(0,t);i=Math.min(i,this.vScroller.height-this.vScroller.buttonHeight),i/=this.vScroller.height-this.vScroller.buttonHeight,this.noPaging?this.tableContent.scrollTo(this.tableContent.scrollLeft,24*this.table.length*i):(this.vScroller.buttonTop=i*(this.vScroller.height-this.vScroller.buttonHeight),this.$refs.vScrollButton.style.marginTop=this.vScroller.buttonTop+"px",this.pageTop=Math.round((this.table.length-this.pageSize)*i))},vsbMouseDown(e){e.stopPropagation(),this.vScroller.mouseY||(this.vScroller.saveButtonTop=this.vScroller.buttonTop,this.vScroller.mouseY=e.clientY,window.addEventListener("mousemove",this.vsbMouseMove),window.addEventListener("mouseup",this.vsbMouseUp),this.$refs.vScrollButton.classList.add("focus"))},vsbMouseUp(){if(window.removeEventListener("mousemove",this.vsbMouseMove),window.removeEventListener("mouseup",this.vsbMouseUp),this.lazy((()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")})),this.vScroller.mouseY=0,!this.noPaging){const e=this.vScroller.buttonTop/(this.vScroller.height-this.vScroller.buttonHeight);this.pageTop=Math.round((this.table.length-this.pageSize)*e)}this.vScroller.runner="";const e=x();e?.proxy?.$forceUpdate()},vsbMouseMove(e){if(0===e.buttons)this.vsbMouseUp();else{const t=e.clientY-this.vScroller.mouseY;if(this.noPaging){const e=(this.vScroller.saveButtonTop+t)/(this.vScroller.height-this.vScroller.buttonHeight);this.tableContent.scrollTo(this.tableContent.scrollLeft,24*this.table.length*e)}else{this.vScroller.buttonTop=Math.max(0,Math.min(this.vScroller.height-this.vScroller.buttonHeight,this.vScroller.saveButtonTop+t)),this.$refs.vScrollButton.style.marginTop=this.vScroller.buttonTop+"px";const e=this.vScroller.buttonTop/(this.vScroller.height-this.vScroller.buttonHeight),i=Math.round((this.table.length-this.pageSize)*e)+1,s=this.table[i];this.vScroller.runner=i+"<br>"+this.fields.filter(((e,t)=>e.keyField||e.sticky||this.sortPos===t)).map((e=>e.label+": "+s[e.name])).join("<br>");const l=x();l?.proxy?.$forceUpdate()}}},ftMouseDown(e){const t=this.footer.getBoundingClientRect(),i=(e.x-t.left-40)/(t.width-40),s=this.systable.getBoundingClientRect().width,l=this.tableContent.getBoundingClientRect().width;this.tableContent.scrollTo(s*i-l/2,this.tableContent.scrollTop)},sbMouseDown(e){if(e.stopPropagation(),!this.hScroller.mouseX){const t=this.$refs.hScroll.getBoundingClientRect().left,i=this.footer.getBoundingClientRect().left+40;this.hScroller.left=t-i,this.hScroller.mouseX=e.clientX,window.addEventListener("mousemove",this.sbMouseMove),window.addEventListener("mouseup",this.sbMouseUp),this.$refs.hScroll.classList.add("focus")}},sbMouseUp(){window.removeEventListener("mousemove",this.sbMouseMove),window.removeEventListener("mouseup",this.sbMouseUp),this.lazy((()=>{this.$refs.hScroll&&this.$refs.hScroll.classList.remove("focus")})),this.hScroller.mouseX=0;const e=x();e?.proxy?.$forceUpdate()},sbMouseMove(e){if(0===e.buttons)this.sbMouseUp();else{const t=e.clientX-this.hScroller.mouseX,i=(this.hScroller.left+t)/this.hScroller.scrollerUnseenWidth;this.tableContent.scrollTo(this.hScroller.tableUnseenWidth*i,this.tableContent.scrollTop)}},tableScroll(){if(this.showDatePicker=!1,this.autocompleteInputs=[],this.focused&&this.currentField&&(this.inputSquare.style.marginLeft=(this.currentField.sticky?this.tableContent.scrollLeft-this.squareSavedLeft:0)+"px"),this.tableContent.scrollTop!==this.vScroller.lastTop&&(this.calVScroll(),this.$refs.vScrollButton&&(this.$refs.vScrollButton.classList.add("focus"),this.lazy((()=>this.$refs.vScrollButton.classList.remove("focus")),1e3))),this.vScroller.lastTop=this.tableContent.scrollTop,this.tableContent.scrollLeft!==this.hScroller.lastLeft&&this.$refs.hScroll&&this.hScroller.tableUnseenWidth){this.$refs.hScroll.classList.add("focus"),this.lazy((()=>this.$refs.hScroll.classList.remove("focus")),1e3);const e=this.tableContent.scrollLeft/this.hScroller.tableUnseenWidth;this.$refs.hScroll.style.left=this.hScroller.scrollerUnseenWidth*e+"px"}this.hScroller.lastLeft=this.tableContent.scrollLeft},winScroll(){this.showDatePicker=!1,this.autocompleteInputs=[]},mousewheel(e){if(this.noMouseScroll||!this.mousein||!e.deltaY)return;let t=0;return e.deltaY>1*this.wheelSensitivity&&this.pageTop+this.pageSize<this.table.length?t=1:e.deltaY<-1*this.wheelSensitivity&&this.pageTop>0&&(t=-1),t&&(this.pageTop+=t,setTimeout(this.calVScroll),this.$refs.vScrollButton&&(this.$refs.vScrollButton.classList.add("focus"),this.lazy((()=>this.$refs.vScrollButton.classList.remove("focus")),1e3))),e.preventDefault(),e.stopPropagation(),!1},winResize(){this.lazy(this.refreshPageSize,500)},winPaste(e){if("TEXTAREA"!==e.target.tagName)return;if(!this.mousein&&!this.focused)return;if(!this.currentField||this.currentField.readonly)return;if(this.inputBoxShow)return void(this.inputBoxChanged=!0);const t=(e.originalEvent||e).clipboardData.getData("text/plain");this.inputCellWrite(t),e.preventDefault()},winKeyup(e){e.altKey||this.systable.classList.remove("alt")},winKeydown(e){if(e.altKey&&this.systable.classList.add("alt"),this.mousein||this.focused)if(e.ctrlKey||e.metaKey)switch(e.keyCode){case 90:this.undoTransaction(),e.preventDefault();break;case 65:this.toggleSelectAllRecords(),e.preventDefault();break;case 67:this.inputBox.value=this.currentCell.textContent,this.inputBox.focus(),this.inputBox.select(),document.execCommand("copy"),e.preventDefault();break;case 70:this.noFinding||(this.$refs.panelFind.showPanel(),e.preventDefault());break;case 71:this.noFindingNext||""===this.inputFind||(this.doFindNext(),e.preventDefault());break;case 76:e.preventDefault(),this.calAutocompleteList(!0)}else{if(this.currentRowPos<0)return;switch(e.keyCode){case 37:if(!this.focused)return;this.inputBoxShow?0===this.inputBox.selectionStart&&(this.moveWest(e),e.preventDefault()):(this.moveWest(e),e.preventDefault());break;case 38:if(!this.focused)return;if(e.preventDefault(),0===this.autocompleteInputs.length)this.moveNorth();else if(this.autocompleteSelect>0){this.autocompleteSelect--;const e=23*this.autocompleteSelect;e<this.$refs.autocomplete.scrollTop&&(this.$refs.autocomplete.scrollTop=e)}else-1===this.autocompleteSelect&&(this.autocompleteSelect=0);break;case 9:if(!this.focused)return;if(e.shiftKey){if(!this.moveWest(e)){if(!this.moveNorth(e))return this.inputBoxBlur();this.moveToEast(e)}}else if(!this.moveEast(e)){if(!this.moveSouth(e))return this.inputBoxBlur();this.moveToWest(e)}e.preventDefault();break;case 39:if(!this.focused)return;this.inputBoxShow?this.inputBox.selectionEnd===this.inputBox.value.length&&(this.moveEast(e),e.preventDefault()):(this.moveEast(e),e.preventDefault());break;case 40:if(!this.focused)return;if(e.preventDefault(),0===this.autocompleteInputs.length)this.moveSouth(e);else if(this.autocompleteSelect<this.autocompleteInputs.length-1&&(this.autocompleteSelect++,this.autocompleteSelect>=10)){const e=23*this.autocompleteSelect-206;this.$refs.autocomplete.scrollTop<e&&(this.$refs.autocomplete.scrollTop=e)}break;case 13:if(!this.focused)return;e.preventDefault(),0===this.autocompleteInputs.length||-1===this.autocompleteSelect?this.enterToSouth?this.moveSouth(e):this.moveEast(e):-1!==this.autocompleteSelect&&this.autocompleteSelect<this.autocompleteInputs.length?this.inputAutocompleteText(this.autocompleteInputs[this.autocompleteSelect]):(this.inputBox.value=this.currentCell.textContent,this.inputBoxShow=0,this.inputBoxChanged=!1),this.inputBoxComplete();break;case 27:if(!this.focused)return;this.showDatePicker=!1,this.autocompleteInputs=[],this.autocompleteSelect=-1,this.inputBoxShow&&(e.preventDefault(),this.inputBox.value=this.currentCell.textContent,this.inputBoxShow=0,this.inputBoxChanged=!1);break;case 33:this.prevPage(),e.preventDefault();break;case 34:this.nextPage(),e.preventDefault();break;case 8:case 46:if(!this.focused)return;if(this.inputBoxShow)return this.inputBoxChanged=!0,void setTimeout((()=>this.calAutocompleteList(!0)));if(this.currentField.readonly)return;if(this.autocompleteInputs.length)return;this.inputBoxChanged=!0,this.inputBox.value="",this.inputBoxComplete();break;default:if(!this.focused)return;if(this.currentField.readonly)return;if(e.altKey)return;if("Process"!==e.key&&e.key.length>1)return;if(!this.inputBoxShow&&"date"===this.currentField.type)return void this.showDatePickerDiv();if(this.currentField.allowKeys)if("Function"===this.currentField.allowKeys.constructor.name){if(!this.currentField.allowKeys(e.key.toUpperCase()))return e.preventDefault()}else if(-1===this.currentField.allowKeys.indexOf(e.key.toUpperCase()))return e.preventDefault();if(this.inputBoxShow&&this.currentField.lengthLimit&&this.inputBox.value.length>=this.currentField.lengthLimit)return e.preventDefault();if(this.inputBoxShow)setTimeout((()=>this.calAutocompleteList(this.autocompleteInputs.length)));else{if("select"===this.currentField.type||"map"===this.currentField.type)return setTimeout((()=>this.calAutocompleteList(!0))),32===e.keyCode?e.preventDefault():(this.inputBox.value="",this.inputBoxShow=1,void this.inputBox.focus());this.inputBox.value="",this.inputBoxShow=1,this.inputBox.focus(),setTimeout(this.calAutocompleteList)}this.inputBoxChanged=!0}}},colSepMouseDown(e){if(e.preventDefault(),e.stopPropagation(),this.allowAddCol&&!e.target.classList.contains("col-sep")){e.target.style.display="none";const t=e.target.parentElement.parentElement,i=Array.from(t.parentElement.children).findIndex((e=>e===t));this.insertColumn(i)}this.focused=!1;const t=(e,t)=>{window.getComputedStyle(e,null).getPropertyValue(t)},i=Array.from(this.labelTr.children).indexOf(e.target.parentElement);this.sep={},this.sep.curCol=this.colgroupTr.children[i-(this.noNumCol?1:0)],this.sep.curField=this.fields[i-1],this.sep.pageX=e.pageX;let s=0;if("border-box"!==t(this.sep.curCol,"box-sizing")){const e=t(this.sep.curCol,"padding-left"),i=t(this.sep.curCol,"padding-right");e&&i&&(s=parseInt(e)+parseInt(i))}this.sep.curColWidth=e.target.parentElement.offsetWidth-s,window.addEventListener("mousemove",this.colSepMouseMove),window.addEventListener("mouseup",this.colSepMouseUp)},colSepMouseOver(e){e.target.classList.contains("col-sep")?(e.target.style.borderRight="5px solid #cccccc",e.target.style.height=this.systable.getBoundingClientRect().height+"px",this.allowAddCol&&(e.target.children[0].style.display="block")):(this.addColBtnTimeout&&clearTimeout(this.addColBtnTimeout),this.allowAddCol&&(e.target.style.display="block"))},colSepMouseOut(e){e.target.classList.contains("col-sep")?(e.target.style.borderRight="5px solid transparent",e.target.style.height="100%",this.addColBtnTimeout=setTimeout((()=>{e.target.children[0].style.display="none"}),500)):e.target.style.display="none"},colSepMouseMove(e){if(!this.sep||!this.sep.curCol)return;const t=e.pageX-this.sep.pageX,i=this.sep.curColWidth+t+"px";this.sep.curCol.style.width=i,this.sep.curField.width=i,this.lazy(this.calStickyLeft,200)},colSepMouseUp(e){e.preventDefault(),e.stopPropagation(),delete this.sep,window.removeEventListener("mousemove",this.colSepMouseMove),window.removeEventListener("mouseup",this.colSepMouseUp);const t=this.getSetting();this.remember&&(localStorage[window.location.pathname+"."+this.token]=JSON.stringify(t)),this.$emit("setting",t)},doFindNext(){return this.doFind()},doFind(e){void 0===e?e=this.inputFind:this.inputFind=e,e=e.toUpperCase();const t=Math.max(0,this.currentRowPos);for(let i=t+this.pageTop;i<this.table.length;i++){const s=this.table[i];for(let l=i===t+this.pageTop?this.currentColPos+1:0;l<this.fields.length;l++){const t=this.fields[l].name;if(void 0!==s[t]&&String(s[t]).toUpperCase().indexOf(e)>=0)return this.pageTop=this.findPageTop(i),setTimeout((()=>{this.moveInputSquare(i-this.pageTop,l),setTimeout((()=>this.inputBox.focus())),this.focused=!0})),!0}}for(let i=0;i<=t+this.pageTop;i++){const s=this.table[i];for(let l=0;l<(i===t+this.pageTop?this.currentColPos:this.fields.length);l++){const t=this.fields[l].name;if(void 0!==s[t]&&String(s[t]).toUpperCase().indexOf(e)>=0)return this.pageTop=this.findPageTop(i),this.moveInputSquare(i-this.pageTop,l),setTimeout((()=>{this.focused=!0})),!0}}return!1},findPageTop(e){for(let t=this.pageTop;t<this.table.length;t+=this.pageSize)if(e>=t&&e<t+this.pageSize)return t;for(let t=this.pageTop;t>0;t-=this.pageSize)if(e>=t&&e<t+this.pageSize)return t;return this.pageTop},headerClick(e,t){if(!this.noHeaderEdit&&"SPAN"===e.target.tagName)return e.target.contentEditable=!0,void e.target.addEventListener("focusout",this.completeHeaderChange);1===e.which&&(e.preventDefault(),this.sortPos===t&&this.sortDir>0?this.sort(-1,t):this.sort(1,t))},completeHeaderChange(e){const t=e.target.parentElement.parentElement,i=Array.from(t.parentElement.children).findIndex((e=>e===t));this.fields[i-1].label=e.target.textContent},sort(e,t){this.processing=!0;const i=void 0===t?this.columnFilterRef.colPos:t,s=this.fields[i],l=s.name;setTimeout((()=>{let t=s.sort;null===t&&(t="number"===s.type?(e,t)=>Number(e[l])>Number(t[l])?1:Number(e[l])<Number(t[l])?-1:0:(e,t)=>String(e[l]).localeCompare(String(t[l]))),this.modelValue.sort(((i,s)=>t(i,s)*-e)),this.sortPos=i,this.sortDir=e,this.refresh(),this.processing=!1}),0)},refreshPageSize(){if(this.$refs.hScroll){const e=this.systable.getBoundingClientRect().width,t=this.tableContent.getBoundingClientRect().width;this.hScroller.tableUnseenWidth=e-t,this.$refs.hScroll.style.width=100*t/e+"%";const i=this.$refs.hScroll.getBoundingClientRect().width;this.hScroller.scrollerUnseenWidth=this.footer.getBoundingClientRect().width-40-i}if(this.noPaging){if("auto"===this.height){let e=Math.floor(window.innerHeight-this.tableContent.getBoundingClientRect().top-25),t=4;this.filterRow&&(t+=29),this.summaryRow&&(t+=25),this.footerRow||(t+=25),e=Math.min(24*(this.table.length-this.pageTop)+t,e),this.systable.parentNode.style.height=e+"px"}}else{const e=this.summaryRow?60:35;let t=window.innerHeight-this.recordBody.getBoundingClientRect().top-e;const i=1*this.height.replace(/px/,"")+this.systable.getBoundingClientRect().top-this.recordBody.getBoundingClientRect().top;this.height&&t>i&&(t=i),this.pageSize=this.page||Math.floor(t/24)}this.columnFillWidth(),setTimeout(this.calVScroll)},firstPage(e){e&&e.stopPropagation(),this.pageTop=0,this.calVScroll(),this.$refs.vScrollButton&&setTimeout((()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy((()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")}),1e3)}))},lastPage(e){e&&e.stopPropagation(),this.pageTop=this.table.length-this.pageSize<0?0:this.table.length-this.pageSize,this.calVScroll(),this.$refs.vScrollButton&&setTimeout((()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy((()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")}),1e3)}))},prevPage(e){e&&e.stopPropagation(),this.pageTop=this.pageTop<this.pageSize?0:this.pageTop-this.pageSize,this.calVScroll(),this.$refs.vScrollButton&&setTimeout((()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy((()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")}),1e3)}))},nextPage(e){e&&e.stopPropagation(),this.pageTop+this.pageSize<this.table.length&&(this.pageTop=Math.min(this.pageTop+this.pageSize,this.table.length-this.pageSize)),this.calVScroll(),this.$refs.vScrollButton&&setTimeout((()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy((()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")}),1e3)}))},getSetting(){const e=Array.from(this.colgroupTr.children).map((e=>e.style.width)),t=this.fields.map(((t,i)=>({name:t.name,invisible:t.invisible,width:e[i+1],label:t.label})));return{colHash:this.colHash,fields:t}},settingClick(){this.disablePanelSetting||this.$refs.panelSetting.showPanel()},panelFilterClick(e){this.disablePanelFilter||this.$refs.panelFilter.showPanel(this.$refs[`filter-${e.name}`][0])},importTable(e,t){this.$refs.importFile.click(),this.importCallback=e,this.importErrorCallback=t},doImport(e){this.processing=!0,this.clearAllSelected(),setTimeout((()=>{const t=e.target.files;if(!t||0===t.length)return;const i=t[0],s=new FileReader;s.onload=async e=>{try{const t=e.target.result,i=M(t,{type:"binary",cellDates:!0,cellStyle:!1}),s=i.SheetNames[0];let l=$.sheet_to_row_object_array(i.Sheets[s]);l=l.filter((e=>Object.keys(e).length>0)).map((e=>(e.key_1&&(e.key=e.key_1,delete e.key_1),Object.keys(e).forEach((t=>{"string"==typeof e[t]&&(e[t]=e[t].replace(/[ \r\n\t]+$/g,""))})),e)));const o=String((new Date).getTime()%1e8);if(0===l.length)throw this.importErrorCallback&&this.importErrorCallback("noRecordIsRead"),new Error("VueExcelEditor: "+this.localizedLabel.noRecordIsRead);if(this.fields.filter((e=>e.keyField)).filter((e=>void 0===l[0][e.name]&&void 0===l[0][e.label])).length>0)throw this.importErrorCallback&&this.importErrorCallback("missingKeyColumn"),new Error(`VueExcelEditor: ${this.localizedLabel.missingKeyColumn}`);let n=0,r=0,a=0;for(;n<2;){const e=this.fields.filter((e=>e.keyField));let t=[];await Promise.all(l.map((async(i,s)=>{let l=-1;if(e.length&&(l=this.table.findIndex((t=>e.filter((e=>void 0!==t[e.name]&&(t[e.name]===i[e.name]||t[e.name]===i[e.label]))).length===e.length)),-1===l)){const s=e.map((e=>i[e.name]||i[e.label])).join(":");if(s){if(t.includes(s))return;t.push(s)}}-1===l&&(l=this.table.findIndex((e=>0===Object.keys(e).filter((e=>!e.startsWith("$"))).length)));const c={$id:void 0===i.$id?o+"-"+("000000"+s).slice(-7):i.$id};await Promise.all(this.fields.map((async e=>{if(e.name.startsWith("$"))return;let t=i[e.name];if(void 0===t&&(t=i[e.label]),void 0===t)t=null;else{if(e.readonly)throw this.importErrorCallback&&this.importErrorCallback("readonlyColumnDetected",s+1),new Error(`VueExcelEditor: [row=${s+1}] `+this.localizedLabel.readonlyColumnDetected+": "+e.name);if(e.change){if(!1===await e.change(t,c[e.name],c,e))throw this.importErrorCallback&&this.importErrorCallback("columnHasValidationError",s+1),new Error(`VueExcelEditor: [row=${s+1}, val=${t}] `+this.localizedLabel.columnHasValidationError(e.name,""))}if(e.validate){let i;if(i=e.validate(t,c[e.name],c,e))throw this.importErrorCallback&&this.importErrorCallback("columnHasValidationError",s+1,t),new Error(`VueExcelEditor: [row=${s+1}, val=${t}] `+this.localizedLabel.columnHasValidationError(e.name,i))}if(this.validate){let i;if(i=this.validate(t,c[e.name],c,e))throw this.importErrorCallback&&this.importErrorCallback("rowHasValidationError",s+1,t),new Error(`VueExcelEditor: [row=${s+1}, val=${t}] `+this.localizedLabel.rowHasValidationError(s+1,e.name,i))}}if(null!==t)c[e.name]=t;else if(e.mandatory)throw this.importErrorCallback&&this.importErrorCallback(e.mandatory,s+1,t),new Error(`VueExcelEdutor: [row=${s+1}, val=${t}] `+e.mandatory)}))),1===n&&(l>=0?(a++,Object.keys(c).forEach((e=>{e.startsWith("$")||this.updateCell(l,e,c[e])})),this.selected[l]=this.table[l].$id):(this.newRecord(c,!0),r++))}))),n++}2===n&&this.importCallback&&this.importCallback({inserted:r,updated:a,recordAffected:r+a})}catch(e){throw this.importErrorCallback&&this.importErrorCallback(e.message),new Error("VueExcelEditor: "+e.stack)}finally{this.processing=!1,this.$refs.importFile.modelValue=""}},s.onerror=e=>{throw this.processing=!1,this.$refs.importFile.modelValue="",this.importErrorCallback&&this.importErrorCallback(e.message),new Error("VueExcelEditor: "+e.stack)},s.readAsBinaryString(i)}),500)},exportTable(e,t,i){this.processing=!0,setTimeout((()=>{const s=$.book_new();let l=null,o=this.table;t&&(o=this.table.filter(((e,t)=>this.selected[t])));const n=o.map((e=>{const t={};return this.fields.forEach((i=>t[i.name]=e[i.name])),t}));l=$.json_to_sheet(n,{header:this.fields.map((e=>e.name))});const r=Array.from(this.labelTr.children).slice(1).map((e=>e.children[0].innerText));switch($.sheet_add_aoa(l,[r],{origin:0}),l["!cols"]=Array.from(this.labelTr.children).slice(1).map((e=>({width:e.getBoundingClientRect().width/6.5}))),$.book_append_sheet(s,l,"Sheet1"),i=i||"export",e){case"csv":i.endsWith(".csv")||(i+=".csv");break;case"xls":i.endsWith(".xls")||(i+=".xls");break;default:i.endsWith(".xlsx")||(i+=".xlsx")}i.endsWith(".xlsx")?z(s,i,{compression:"DEFLATE",compressionOptions:{level:6}}):z(s,i),this.processing=!1}),500)},getSelectedRecords(){return this.table.filter(((e,t)=>this.selected[t]))},rowLabelClick(e){let t=e.target;for(;"TD"!==t.tagName;)t=t.parentNode;const i=Number(t.getAttribute("pos"))+this.pageTop;if(e.shiftKey){if(document.getSelection().removeAllRanges(),-1!==this.prevSelect&&this.prevSelect!==i)if(e.preventDefault(),i>this.prevSelect)for(let s=this.prevSelect;s<=i;s++)this.selectRecord(s);else for(let s=i;s<=this.prevSelect;s++)this.selectRecord(s)}else{const t=this.selected[i];this.freeSelect||e.ctrlKey||e.metaKey||this.clearAllSelected(),t?this.unSelectRecord(i):this.selectRecord(i)}this.prevSelect=i},selectAllClick(){this.toggleSelectAllRecords()},reviseSelectedAfterTableChange(){this.rowIndex={},this.table.forEach(((e,t)=>this.rowIndex[e.$id]=t));const e=Object.assign(this.selected);this.selected={},Object.keys(e).forEach((t=>{const i=e[t];void 0!==this.rowIndex[i]&&(this.selected[this.rowIndex[i]]=i)})),this.selectedCount=Object.keys(this.selected).length},toggleSelectRecord(e){void 0!==this.selected[e]?this.unSelectRecord(e):this.selectRecord(e)},selectRecord(e){void 0===this.selected[e]&&(this.selectedCount++,this.selected[e]=this.table[e].$id,this.recordBody.children[e-this.pageTop]&&this.recordBody.children[e-this.pageTop].classList.add("select"),this.lazy(e,(e=>{this.$emit("select",e,!0)})))},selectRecordByKeys(e){const t=this.table.findIndex((t=>this.fields.filter((e=>e.keyField)).filter((i=>t[i.name]===e[i.name])).length===e.length));t>=0&&this.selectRecord(t)},selectRecordById(e){const t=this.table.findIndex((t=>t.$id===e));t>=0&&this.selectRecord(t)},unSelectRecord(e){void 0!==this.selected[e]&&(delete this.selected[e],this.selectedCount--,this.recordBody.children[e-this.pageTop]&&this.recordBody.children[e-this.pageTop].classList.remove("select"),this.lazy(e,(e=>{this.$emit("select",e,!1)})))},toggleSelectAllRecords(e){if(e&&e.preventDefault(),this.selectedCount>0)this.clearAllSelected();else{for(let e=0;e<this.table.length;e++)this.selectRecord(e);this.selectedCount=this.table.length}},clearAllSelected(){this.selectedCount>0&&this.$emit("select",Object.keys(this.selected).map((e=>Number(e))),!1),this.selected={},this.selectedCount=0},moveTo(e,t){t=t||0;const i=this.moveInputSquare(e-this.pageTop,t);return this.focused=!0,setTimeout((()=>this.inputBox.focus())),i},moveToNorthWest(){let e=0;for(;this.fields[e].invisible&&e<this.fields.length-1;)e++;return this.moveTo(0,e)},moveToNorthEast(){let e=this.fields.length-1;for(;this.fields[e].invisible&&e>0;)e--;return this.moveTo(0,e)},moveToSouthWest(){let e=this.table.length-1,t=0;for(;this.fields[t].invisible&&t<this.fields.length-1;)t++;return this.moveTo(e,t)},moveToSouthEast(){let e=this.table.length-1,t=this.fields.length-1;for(;this.fields[t].invisible&&t>0;)t--;return this.moveTo(e,t)},moveToWest(){let e=this.currentRowPos,t=0;for(;this.fields[t].invisible&&t<this.fields.length-1;)t++;return this.moveTo(e,t)},moveToEast(){let e=this.currentRowPos,t=this.fields.length-1;for(;this.fields[t].invisible&&t>0;)t--;return this.moveTo(e,t)},moveWest(){if(this.focused&&this.currentColPos>0){let e=this.currentColPos-1;for(;this.fields[e].invisible&&e>0;)e--;return-1!==e&&!this.fields[e].invisible&&this.moveInputSquare(this.currentRowPos,e)}return!1},moveEast(){if(this.focused&&this.currentColPos<this.fields.length-1){let e=this.currentColPos+1;for(;this.fields[e].invisible&&e<this.fields.length-1;)e++;return e!==this.fields.length&&!this.fields[e].invisible&&this.moveInputSquare(this.currentRowPos,e)}return!1},moveNorth(){if(this.focused){const e=this.moveInputSquare(this.currentRowPos-1,this.currentColPos);return this.calVScroll(),this.$refs.vScrollButton&&setTimeout((()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy((()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")}),1e3)})),e}return!1},moveSouth(){if(this.focused){if(this.currentRowPos+1>=this.pageBottom-this.pageTop&&this.pageBottom>=this.table.length)return!this.readonly&&(!!this.newIfBottom&&(this.newRecord({},!1,!0),setTimeout(this.moveSouth,0),!0));const e=this.moveInputSquare(this.currentRowPos+1,this.currentColPos);return this.calVScroll(),this.$refs.vScrollButton&&setTimeout((()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy((()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")}),1e3)})),e}return!1},mouseDown(e){if("TBODY"===e.target.parentNode.parentNode.tagName&&!e.target.classList.contains("first-col")){e.preventDefault(),setTimeout((()=>this.inputBox.focus())),this.focused=!0;const t=e.target.parentNode,i=Array.from(t.children).indexOf(e.target)-1,s=Array.from(t.parentNode.children).indexOf(t);if(this.$emit("cell-click",{rowPos:s,colPos:i}),this.moveInputSquare(s,i),this.currentField&&this.currentField.link&&e.altKey&&setTimeout((()=>this.currentField.link(this.currentCell.textContent,this.currentRecord,s,i,this.currentField,this))),e.target.offsetWidth-e.offsetX>15)return;if(this.currentField.readonly)return;this.inputBox.value=this.currentCell.textContent,e.target.classList.contains("select")&&this.calAutocompleteList(!0),e.target.classList.contains("datepick")&&this.showDatePickerDiv()}},cellMouseMove(e){let t="cell";this.inputBoxShow&&(t="default"),!e.target.classList.contains("readonly")&&(e.target.classList.contains("select")||e.target.classList.contains("datepick"))&&e.target.offsetWidth-e.offsetX<15&&(t="pointer"),e.target.style.cursor=t},cellMouseOver(e){const t=e.target;if(!t.classList.contains("error"))return;if(this.tipTimeout&&clearTimeout(this.tipTimeout),""===(this.tip=this.errmsg[t.getAttribute("id")]))return;const i=t.getBoundingClientRect();this.$refs.tooltip.style.top=i.top-14+"px",this.$refs.tooltip.style.left=i.right+8+"px",t.addEventListener("mouseout",this.cellMouseOut)},numcolMouseOver(e){const t=e.target;if(!t.classList.contains("error"))return;if(this.tipTimeout&&clearTimeout(this.tipTimeout),""===(this.tip=this.rowerr[t.getAttribute("id")]))return;const i=t.getBoundingClientRect();this.$refs.tooltip.style.top=i.top-14+"px",this.$refs.tooltip.style.left=i.right+8+"px",t.addEventListener("mouseout",this.cellMouseOut)},cellMouseOut(e){this.tipTimeout=setTimeout((()=>{this.tip=""}),1e3),e.target.removeEventListener(e.type,this.cellMouseOut)},mouseOver(){this.mousein=!0,this.systable.classList.add("mouseover")},mouseOut(){this.mousein=!1,this.systable.classList.remove("mouseover")},moveInputSquare(e,t){if(t<0)return!1;const i=this.pageTop;let s=this.recordBody.children[e];if(!s)if(e>this.currentRowPos){if(!(this.pageTop+this.pageSize<this.table.length))return!1;this.pageTop+=1,s=this.recordBody.children[--e]}else{if(!(this.pageTop-1>=0))return!1;this.pageTop-=1,s=this.recordBody.children[++e]}this.labelTr.children[this.currentColPos+1].classList.remove("focus"),this.currentRowPos>=0&&this.currentRowPos<this.pagingTable.length&&this.recordBody.children[this.currentRowPos].children[0].classList.remove("focus"),this.inputBoxShow&&(this.inputBoxShow=0),this.inputBoxChanged&&(this.inputCellWrite(this.inputBox.value,this.currentColPos,i+this.currentRowPos),this.inputBoxChanged=!1);const l=s.children[t+1];if(!l)return!1;this.currentField=this.fields[t];const o=l.getBoundingClientRect(),n=this.systable.getBoundingClientRect();if(this.squareSavedLeft=this.tableContent.scrollLeft,this.inputSquare.style.marginLeft=0,this.inputSquare.style.left=o.left-n.left-1+"px",this.inputSquare.style.top=o.top-n.top-1+"px",this.inputSquare.style.width=o.width+1+"px",this.inputSquare.style.height=o.height+1+"px",this.inputSquare.style.zIndex=this.currentField.sticky?3:1,!this.currentField.sticky){const e=this.$el.getBoundingClientRect();o.right>=e.right-12&&this.tableContent.scrollBy(o.right-e.right+13,0),o.left<=e.left+this.leftMost&&this.tableContent.scrollBy(o.left-e.left-this.leftMost-1,0)}return this.currentRowPos=e,this.currentColPos=t,this.currentCell=l,this.currentRecord=this.table[i+e],this.$emit("cell-focus",{rowPos:e,colPos:t,cell:l,record:this.currentRecord}),this.showDatePicker&&(this.showDatePicker=!1),this.autocompleteInputs.length&&(this.autocompleteInputs=[],this.autocompleteSelect=-1),this.recalAutoCompleteList&&clearTimeout(this.recalAutoCompleteList),this.currentRowPos>=0&&this.currentRowPos<this.pagingTable.length&&(this.inputBox.value=this.currentCell.textContent,this.inputBox.focus(),this.focused=!0,s.children[0].classList.add("focus"),this.labelTr.children[t+1].classList.add("focus")),!0},inputSquareClick(){this.currentField.readonly||this.inputBoxShow||"select"===this.currentField.type||(this.inputBox.value=this.currentCell.textContent,this.inputBoxShow=1,this.inputBox.focus(),this.inputBoxChanged=!1,this.focused=!0)},inputBoxMouseMove(e){let t="text";!this.currentField.readonly&&(this.currentField.options||"date"===this.currentField.type)&&e.target.offsetWidth-e.offsetX<15&&(t="pointer"),e.target.style.cursor=t},inputBoxMouseDown(e){e.target.offsetWidth-e.offsetX>15||this.currentField.readonly||(this.currentField.options&&(e.preventDefault(),this.calAutocompleteList(!0)),"date"===this.currentField.type&&(e.preventDefault(),this.showDatePickerDiv()))},inputCellWrite(e,t,i){let s=this.currentField;void 0!==t&&(s=this.fields[t]),void 0===i&&(i=this.pageTop+this.currentRowPos),void 0!==this.selected[i]?this.updateSelectedRows(s,s.toValue(e)):this.updateCell(i,s,s.toValue(e))},inputBoxBlur(){this.$refs.dpContainer&&(this.$refs.dpContainer.querySelector(":hover")||(this.inputBoxComplete(),this.focused=!1,-1!==this.currentRowPos&&this.currentRowPos<this.recordBody.children.length&&(this.recordBody.children[this.currentRowPos].children[0].classList.remove("focus"),this.labelTr.children[this.currentColPos+1].classList.remove("focus"))))},inputBoxComplete(){this.inputBoxChanged&&(this.inputCellWrite(this.inputBox.value),this.inputBoxChanged=!1),this.inputBoxShow=0,this.showDatePicker=!1,this.focused=!1,this.focused=!0},undoTransaction(e){if(e&&e.preventDefault(),0===this.redo.length)return;this.redo.pop().every((t=>{try{if("d"===t.type)this.newRecord(t.rec,!1,!0,!0);else if(t.field&&t.field.keyField&&t.oldKeys.includes(t.newVal)){const e=this.modelValue.findIndex((e=>e.$id===t.$id));e>=0&&this.deleteRecord(e,!0)}else this.updateCell(t.$id,t.field.name,t.oldVal,!0);return!0}catch(e){return!1}}))},newRecord(e,t,i,s){void 0===e&&(e={}),this.fields.map((t=>{void 0===e[t.name]&&(t.keyField?e[t.name]="§"+this.tempKey():e[t.name]=null)}));const l=e.$id||this.tempKey();e.$id=l,this.modelValue.push(e);const o=this.table.push(e)-1;return t&&(this.selected[o]=l),Object.keys(e).forEach((t=>{const i=this.fields.find((e=>e.name===t));i&&this.updateCell(e,i,e[t],s)})),i||this.lazy((()=>{this.lastPage(),this.moveToSouthWest()})),e},deleteSelectedRecords(){Object.values(this.selected).forEach((e=>{const t=this.modelValue.findIndex((t=>t.$id===e));t>=0&&this.deleteRecord(t)})),this.selected={},this.selectedCount=0},deleteRecord(e,t){this.currentRowPos===e&&this.moveNorth();const i=this.modelValue.splice(e,1)[0];setTimeout((()=>{this.lazy(i,(e=>{this.$emit("delete",e),t||this.redo.push(e.map((e=>({type:"d",rec:e})))),this.refresh()}))}),100)},async updateCell(e,t,i,s){switch(e.constructor.name){case"String":e=this.modelValue.find((t=>t.$id===e));break;case"Number":e=this.table[e];break;case"Object":break;default:throw new Error("Invalid row argument type")}switch(t.constructor.name){case"String":t=this.fields.find((e=>e.name===t));break;case"Number":t=this.fields[t];break;case"Object":break;default:throw new Error("Invalid field argument type")}if(!t)throw new Error("Invalid field argument");if(!e)return;const l=e[t.name],o=this.getKeys(e);if(t.change){if(!1===await t.change(i,l,e,t))return}e[t.name]=i,setTimeout((()=>{const n={$id:e.$id,keys:this.getKeys(e),oldKeys:o,name:t.name,field:t,oldVal:void 0!==l?l:"",newVal:i,err:""};null!==t.validate&&(n.err=t.validate(i,l,e,t)),t.mandatory&&""===i&&(n.err+=(n.err?"\n":"")+t.mandatory),this.setFieldError(n.err,e,t),null!==this.validate&&(n.rowerr=this.validate(i,l,e,t),this.setRowError(n.rowerr,e)),t.summary&&this.calSummary(t.name),this.lazy(n,(e=>{this.$emit("update",e),s||this.redo.push(e)}),50)}))},updateSelectedRows(e,t){this.processing=!0,setTimeout((()=>{Object.keys(this.selected).forEach((i=>this.updateCell(parseInt(i),e,t))),this.processing=!1}),0)},setFieldError(e,t,i){const s=`id-${t.$id}-${i.name}`,l=this.systable.querySelector("td#"+s);e?(this.errmsg[s]=e,this.$emit("validate-error",e,t,i),l&&l.classList.add("error")):this.errmsg[s]&&(delete this.errmsg[s],this.$emit("validate-error","",t,i),l&&l.classList.remove("error"))},setRowError(e,t){const i=`rid-${t.$id}`,s=this.systable.querySelector("td#"+i);e?(this.rowerr[i]=e,this.$emit("validate-error",e,t),s&&s.classList.add("error")):this.rowerr[i]&&(delete this.rowerr[i],this.$emit("validate-error","",t),s&&s.classList.remove("error"))},async calAutocompleteList(e){if(this.currentField.autocomplete&&(e||this.inputBoxChanged&&this.inputBox.value.length>0)){void 0!==this.recalAutoCompleteList&&clearTimeout(this.recalAutoCompleteList);const t=async()=>{if(!(e||this.focused&&this.inputBoxShow&&this.inputBoxChanged&&this.inputBox.value.length))return void(this.autocompleteInputs=[]);const t=this.currentField,i=t.name,s=this.inputBox.value.toUpperCase(),l=this.autocompleteCount;let o=[];if(t.options)t.options.constructor.name.endsWith("Function")?(o=await t.options(s,this.currentRecord),o="map"===t.type?Object.values(o):o.slice(),this.inputBoxShow&&(o=o.filter((e=>e.toUpperCase().includes(s)))),o.sort().splice(l)):Object.values(t.options).length>0&&(o=t.options,o="map"===t.type?Object.values(o):o.slice(),this.inputBoxShow&&(o=o.filter((e=>e.toUpperCase().includes(s)))),o.sort().splice(l));else{for(let e=0;e<this.modelValue.length;e++){const t=this.modelValue[e];if(void 0!==t[i]&&t[i].toString().toUpperCase().startsWith(s)&&-1===o.indexOf(t[i])&&o.push(t[i]),o.length>=l)break}o.sort()}this.autocompleteSelect=o.findIndex((e=>e?.toString().toUpperCase().startsWith(s))),this.autocompleteInputs=o;const n=this.currentCell.getBoundingClientRect();return this.lazy((()=>{if(!this.$refs.autocomplete)return;this.$refs.autocomplete.style.minWidth=n.width+"px";const e=this.$refs.autocomplete.getBoundingClientRect();n.bottom+e.height>window.innerHeight?(this.autocompleteInputs.reverse(),this.autocompleteSelect=this.autocompleteInputs.length-this.autocompleteSelect-1,this.$refs.autocomplete.style.top=n.top-e.height+"px"):this.$refs.autocomplete.style.top=n.bottom+"px",n.left+e.width>window.innerWidth?this.$refs.autocomplete.style.left=n.right-e.width+"px":this.$refs.autocomplete.style.left=n.left+"px";const t=23*this.autocompleteSelect-206;this.$refs.autocomplete.scrollTop=t>0?t:0})),this.autocompleteSelect};e?t():this.lazy(t,700)}},inputAutocompleteText(e,t){t&&t.preventDefault(),this.autocompleteInputs=[],this.autocompleteSelect=-1,this.inputBoxShow=0,this.inputBoxChanged=!1,setTimeout((()=>{this.inputCellWrite(e)}))},tempKey:()=>(new Date).getTime()%1e8+"-"+Math.random().toString().slice(2,7),hashCode:e=>e.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0),lazy(e,t,i){if("function"!=typeof e)return this.lazyBuf(e,t,i);t||(t=20);const s=this.hashCode(e.name+e.toString());this.lazyTimeout[s]&&clearTimeout(this.lazyTimeout[s]),this.lazyTimeout[s]=setTimeout((()=>{e(),delete this.lazyTimeout[s]}),t)},lazyBuf(e,t,i){i||(i=20);const s=this.hashCode(t.name+t.toString());this.lazyBuffer[s]?this.lazyBuffer[s].push(e):this.lazyBuffer[s]=[e],this.lazyTimeout[s]&&clearTimeout(this.lazyTimeout[s]),this.lazyTimeout[s]=setTimeout((()=>{this.$nextTick((()=>{t(this.lazyBuffer[s]),delete this.lazyTimeout[s],delete this.lazyBuffer[s]}))}),i)}}}),Ie=e=>(f("data-v-514b7dfc"),e=e(),m(),e),Ne={class:"component-content"},We={key:0,style:{width:"40px"}},Ue={key:1,style:{width:"12px"}},qe={class:"center-text"},je={style:{width:"100%"}},Ke={key:0,"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"times-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-times-circle fa-w-16 fa-sm"},_e=[Ie((()=>a("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},null,-1)))],Xe={key:1,"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"bars",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"svg-inline--fa fa-bars fa-w-14 fa-sm"},Ye=[Ie((()=>a("path",{fill:"currentColor",d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},null,-1)))],Je=["colspan","onMousedown","onContextmenu"],Ge=["innerHTML"],Ze=[Ie((()=>a("div",{class:"add-col-btn"}," + ",-1)))],Qe={key:0},et=[Ie((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"eraser",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-eraser fa-w-16 fa-sm"},[a("path",{fill:"currentColor",d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"})],-1)))],tt={key:0},it=[Ie((()=>a("td",{colspan:"100%",style:{height:"40px","vertical-align":"middle","text-align":"center"}},null,-1)))],st=["id","pos"],lt=["innerHTML"],ot=["id","cell-RC"],nt={key:0,class:"last-col"},rt=Ie((()=>a("td",{class:"row-summary first-col"}," ",-1))),at=["colspan"],ct={style:{position:"relative",height:"100%",padding:"2px 2px 1px"}},ht=Ie((()=>a("div",{class:"rb-square"},null,-1))),ut=["spellcheck"],dt={ref:"dpContainer",style:{"z-index":"20",position:"fixed"}},pt={ref:"frontdrop",class:"front-drop"},ft=[Ie((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"spinner",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-3x"},[a("path",{fill:"currentColor",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"})],-1)))],mt=["innerHTML"],gt={ref:"autocomplete",class:"autocomplete-results"},vt=Ie((()=>a("span",{class:"left-block"},null,-1))),bt={style:{position:"absolute",left:"46px"}},yt=["innerHTML"],wt=Ie((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"spinner",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-sm"},[a("path",{fill:"currentColor",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"})],-1))),St=["innerHTML"],xt=Ie((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"step-backward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"svg-inline--fa fa-step-backward fa-w-14 fa-sm"},[a("path",{fill:"currentColor",d:"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"})],-1))),Ct=["innerHTML"],Tt=Ie((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"backward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-backward fa-w-16 fa-sm"},[a("path",{fill:"currentColor",d:"M11.5 280.6l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2zm256 0l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2z"})],-1))),kt=["innerHTML"],Lt=["innerHTML"],Ft=Ie((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"forward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"svg-inline--fa fa-forward fa-w-16 fa-sm"},[a("path",{fill:"currentColor",d:"M500.5 231.4l-192-160C287.9 54.3 256 68.6 256 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2zm-256 0l-192-160C31.9 54.3 0 68.6 0 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2z"})],-1))),Bt=["innerHTML"],Mt=Ie((()=>a("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"step-forward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"svg-inline--fa fa-step-forward fa-w-14 fa-sm"},[a("path",{fill:"currentColor",d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"})],-1))),$t={style:{position:"absolute",right:"6px"}},zt=["innerHTML"],Et=["innerHTML"],Vt={class:h({disabled:!0})},Pt=["innerHTML"];const Rt=E(Ae,[["render",function(i,s,o,f,m,b){const y=g("vue-excel-filter"),w=g("date-picker"),S=g("panel-filter"),x=g("panel-setting"),F=g("panel-find");return e(),t("div",{ref:"editor",class:"vue-excel-editor",style:C({display:"inline-block",width:i.width})},[a("div",Ne,[i.localizedLabel.noRecordIndicator&&0==i.pagingTable.length?(e(),t("div",{key:0,class:"norecord",style:C({bottom:i.noFooter?"12px":"37px"})},c(i.localizedLabel.noRecordIndicator),5)):p("",!0),a("div",{ref:"tableContent",class:h(["table-content",{"no-footer":i.noFooter}]),onScroll:s[16]||(s[16]=(...e)=>i.tableScroll&&i.tableScroll(...e)),onMouseover:s[17]||(s[17]=(...e)=>i.mouseOver&&i.mouseOver(...e)),onMouseout:s[18]||(s[18]=(...e)=>i.mouseOut&&i.mouseOut(...e))},[a("table",{ref:"systable",id:"systable",style:{"table-layout":"fixed",width:"0"},class:h(["systable",{"no-number":i.noNumCol}]),ondragenter:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",ondragover:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'"},[a("colgroup",null,[i.noNumCol?p("",!0):(e(),t("col",We)),(e(!0),t(u,null,d(i.fields,((i,s)=>n((e(),t("col",{key:s,style:C({width:i.width})},null,4)),[[r,!i.invisible]]))),128)),i.vScroller.buttonHeight<i.vScroller.height?(e(),t("col",Ue)):p("",!0)]),a("thead",qe,[a("tr",null,[a("th",{class:h(["center-text first-col tl-setting",{hide:i.noNumCol}]),style:{top:"0"},onMousedown:s[0]||(s[0]=l(((...e)=>i.selectAllClick&&i.selectAllClick(...e)),["left"])),onContextmenu:s[1]||(s[1]=l(((...e)=>i.settingClick&&i.settingClick(...e)),["prevent"]))},[a("span",je,[i.selectedCount>0?(e(),t("svg",Ke,_e)):(e(),t("svg",Xe,Ye))])],34),(e(!0),t(u,null,d(i.fields,((o,c)=>n((e(),t("th",{key:`th-${c}`,colspan:c===i.fields.length-1&&i.vScroller.buttonHeight<i.vScroller.height?2:1,class:h({"sort-asc-sign":i.sortPos==c&&1==i.sortDir,"sort-des-sign":i.sortPos==c&&-1==i.sortDir,"sticky-column":o.sticky}),style:C({left:o.left}),onMousedown:e=>i.headerClick(e,c),onContextmenu:l((e=>i.panelFilterClick(o)),["prevent"])},[a("div",{class:h({"filter-sign":i.columnFilter[c]})},[a("span",{class:h({"table-col-header":!i.noHeaderEdit}),innerHTML:i.headerLabel(o.label,o)},null,10,Ge)],2),a("div",{class:"col-sep",onMousedown:s[2]||(s[2]=(...e)=>i.colSepMouseDown&&i.colSepMouseDown(...e)),onMouseover:s[3]||(s[3]=(...e)=>i.colSepMouseOver&&i.colSepMouseOver(...e)),onMouseout:s[4]||(s[4]=(...e)=>i.colSepMouseOut&&i.colSepMouseOut(...e))},Ze,32)],46,Je)),[[r,!o.invisible]]))),128))]),a("tr",{class:h({hide:!i.filterRow})},[a("td",{class:h(["center-text first-col tl-filter",{hide:i.noNumCol}]),style:C([{"vertical-align":"middle",padding:"0"},{top:i.calCellTop2+"px"}]),onClick:s[5]||(s[5]=e=>i.columnFilter={})},[Object.keys(i.columnFilter).length>0?(e(),t("span",Qe,et)):p("",!0)],6),(e(!0),t(u,null,d(i.fields,((t,s)=>n((e(),T(y,{ref_for:!0,ref:`filter-${t.name}`,colspan:s===i.fields.length-1?2:1,key:`th2-${s}`,modelValue:i.columnFilter[s],"onUpdate:modelValue":e=>i.columnFilter[s]=e,class:h([{"sticky-column":t.sticky},"column-filter"]),style:C({left:t.left})},null,8,["colspan","modelValue","onUpdate:modelValue","class","style"])),[[r,!t.invisible]]))),128))],2)]),a("tbody",{onMousedown:s[10]||(s[10]=(...e)=>i.mouseDown&&i.mouseDown(...e))},[i.localizedLabel.noRecordIndicator&&0==i.pagingTable.length?(e(),t("tr",tt,it)):(e(!0),t(u,{key:1},d(i.pagingTable,((l,o)=>(e(),t("tr",{key:o,class:h({select:void 0!==i.selected[i.pageTop+o]}),style:C(i.rowStyle(l))},[a("td",{class:h(["center-text first-col",{hide:i.noNumCol,error:i.rowerr[`rid-${l.$id}`]}]),id:`rid-${l.$id}`,pos:o,onMouseover:s[6]||(s[6]=(...e)=>i.numcolMouseOver&&i.numcolMouseOver(...e)),onClick:s[7]||(s[7]=(...e)=>i.rowLabelClick&&i.rowLabelClick(...e))},[a("span",{innerHTML:i.recordLabel(i.pageTop+o+1,l)},null,8,lt)],42,st),(e(!0),t(u,null,d(i.fields,((a,u)=>n((e(),t("td",{id:`id-${l.$id}-${a.name}`,"cell-RC":`${o}-${a.name}`,class:h({readonly:a.readonly,error:i.errmsg[`id-${l.$id}-${a.name}`],link:a.link,select:a.options,datepick:"date"==a.type,"sticky-column":a.sticky}),key:u,style:C(Object.assign(i.cellStyle(l,a),i.renderColumnCellStyle(a))),onMouseover:s[8]||(s[8]=(...e)=>i.cellMouseOver&&i.cellMouseOver(...e)),onMousemove:s[9]||(s[9]=(...e)=>i.cellMouseMove&&i.cellMouseMove(...e))},c(a.toText(l[a.name])),47,ot)),[[r,!a.invisible]]))),128)),i.vScroller.buttonHeight<i.vScroller.height?(e(),t("td",nt)):p("",!0)],6)))),128))],32),a("tfoot",null,[n(a("tr",null,[rt,(e(!0),t(u,null,d(i.fields,((s,l)=>n((e(),t("td",{class:h(["row-summary",{"sticky-column":s.sticky,"summary-column1":l+1<i.fields.length&&i.fields[l+1].summary,"summary-column2":s.summary}]),colspan:l===i.fields.length-1&&i.vScroller.buttonHeight<i.vScroller.height?2:1,key:`f${l}`,style:C(i.renderColumnCellStyle(s))},c(i.summary[s.name]),15,at)),[[r,!s.invisible]]))),128))],512),[[r,i.pagingTable.length&&i.summaryRow]])]),k(i.$slots,"default",{},void 0,!0)],2),n(a("div",{ref:"tooltip",class:"tool-tip"},c(i.tip),513),[[r,i.tip]]),n(a("div",{ref:"inputSquare",class:"input-square",onMousedown:s[14]||(s[14]=(...e)=>i.inputSquareClick&&i.inputSquareClick(...e))},[a("div",ct,[ht,a("textarea",{ref:"inputBox",id:"inputBox",class:"input-box",style:C({opacity:i.inputBoxShow}),onBlur:s[11]||(s[11]=(...e)=>i.inputBoxBlur&&i.inputBoxBlur(...e)),onMousemove:s[12]||(s[12]=(...e)=>i.inputBoxMouseMove&&i.inputBoxMouseMove(...e)),onMousedown:s[13]||(s[13]=(...e)=>i.inputBoxMouseDown&&i.inputBoxMouseDown(...e)),trim:"",autocomplete:"off",autocorrect:"off",autocompitaize:"off",spellcheck:i.spellcheck},null,44,ut)])],544),[[r,i.focused]]),n(a("div",dt,[v(w,{ref:"datepicker",inline:"","auto-apply":"",modelValue:i.inputDateTime,"onUpdate:modelValue":[s[15]||(s[15]=e=>i.inputDateTime=e),i.datepickerClick],valueType:"format"},null,8,["modelValue","onUpdate:modelValue"])],512),[[r,i.showDatePicker]]),n(a("div",pt,ft,512),[[r,i.processing]])],34),n(a("div",{ref:"vScroll",class:"v-scroll",style:C({top:`${i.vScroller.top}px`,height:`${i.vScroller.height}px`}),onMousedown:s[20]||(s[20]=(...e)=>i.vsMouseDown&&i.vsMouseDown(...e))},[a("div",{ref:"vScrollButton",class:"v-scroll-button",style:C({marginTop:`${i.vScroller.buttonTop}px`,height:`${i.vScroller.buttonHeight}px`}),onMousedown:s[19]||(s[19]=(...e)=>i.vsbMouseDown&&i.vsbMouseDown(...e))},[n(a("div",{class:"runner",innerHTML:i.vScroller.runner},null,8,mt),[[r,i.vScroller.runner]])],36)],36),[[r,i.vScroller.buttonHeight<i.vScroller.height]]),n(a("ul",gt,[(e(!0),t(u,null,d(i.autocompleteInputs,((o,n)=>(e(),t("li",{key:n,class:h([{select:i.autocompleteSelect===n},"autocomplete-result"]),onMousedown:s[21]||(s[21]=l((e=>i.inputAutocompleteText(e.target.textContent,e)),["left","prevent"]))},c(o),35)))),128))],512),[[r,i.focused&&i.autocompleteInputs.length]]),a("div",{ref:"footer",class:h(["footer center-text",{hide:i.noFooter}]),style:{position:"relative"},onMousedown:s[29]||(s[29]=(...e)=>i.ftMouseDown&&i.ftMouseDown(...e))},[a("div",{ref:"hScroll",class:"h-scroll",onMousedown:s[22]||(s[22]=(...e)=>i.sbMouseDown&&i.sbMouseDown(...e))},null,544),vt,n(a("span",bt,[a("span",{innerHTML:i.localizedLabel.footerLeft(i.pageTop+1,i.pageBottom,i.table.length)},null,8,yt)],512),[[r,!i.noPaging]]),n(a("span",null,[i.processing?(e(),t(u,{key:0},[wt,L("   "),a("span",{innerHTML:i.localizedLabel.processing},null,8,St)],64)):(e(),t(u,{key:1},[a("a",{class:h({disabled:i.pageTop<=0}),onMousedown:s[23]||(s[23]=(...e)=>i.firstPage&&i.firstPage(...e))},[xt,L("   "),a("span",{innerHTML:i.localizedLabel.first},null,8,Ct)],34),L("  |  "),a("a",{class:h({disabled:i.pageTop<=0}),onMousedown:s[24]||(s[24]=(...e)=>i.prevPage&&i.prevPage(...e))},[Tt,L("   "),a("span",{innerHTML:i.localizedLabel.previous},null,8,kt)],34),L("  |  "),a("a",{class:h({disabled:i.pageTop+i.pageSize>=i.table.length}),onMousedown:s[25]||(s[25]=(...e)=>i.nextPage&&i.nextPage(...e))},[a("span",{innerHTML:i.localizedLabel.next},null,8,Lt),L("   "),Ft],34),L("  |  "),a("a",{class:h({disabled:i.pageTop+i.pageSize>=i.table.length}),onMousedown:s[26]||(s[26]=(...e)=>i.lastPage&&i.lastPage(...e))},[a("span",{innerHTML:i.localizedLabel.last},null,8,Bt),L("   "),Mt],34)],64))],512),[[r,!i.noPaging&&i.pageBottom-i.pageTop<i.table.length]]),a("span",$t,[a("a",{class:h({disabled:!i.showSelectedOnly&&i.selectedCount<=1}),onMousedown:s[27]||(s[27]=(...e)=>i.toggleSelectView&&i.toggleSelectView(...e))},[a("span",{innerHTML:i.localizedLabel.footerRight.selected},null,8,zt),a("span",{style:C({color:i.selectedCount>0?"red":"inherit"})},c(i.selectedCount),5)],34),L("  |  "),a("a",{class:h({disabled:"{}"===i.columnFilterString}),onMousedown:s[28]||(s[28]=(...e)=>i.toggleFilterView&&i.toggleFilterView(...e))},[a("span",{innerHTML:i.localizedLabel.footerRight.filtered},null,8,Et),a("span",{style:C({color:i.table.length!==i.filteredValue.length?"red":"inherit"})},c(i.table.length),5)],34),L("  |  "),a("a",Vt,[a("span",{innerHTML:i.localizedLabel.footerRight.loaded},null,8,Pt),a("span",null,c(i.filteredValue.length),1)])])],34),a("input",{type:"file",ref:"importFile",accept:".xlsx, .xls, xlsm, .csv",style:{position:"absolute",top:"0",left:"0",width:"0",height:"0",opacity:"0","z-index":"-1"},onKeyup:s[30]||(s[30]=(...e)=>i.componentTabInto&&i.componentTabInto(...e)),onChange:s[31]||(s[31]=(...e)=>i.doImport&&i.doImport(...e))},null,544),v(S,{ref:"panelFilter","n-filter-count":i.nFilterCount,"localized-label":i.localizedLabel},null,8,["n-filter-count","localized-label"]),v(x,{ref:"panelSetting",modelValue:i.fields,"onUpdate:modelValue":s[32]||(s[32]=e=>i.fields=e),"localized-label":i.localizedLabel},null,8,["modelValue","localized-label"]),v(F,{ref:"panelFind","localized-label":i.localizedLabel},null,8,["localized-label"])])],4)}],["__scopeId","data-v-514b7dfc"]]);const Dt=E({props:{field:{type:String,default:""},label:{type:String,default:null},type:{type:String,default:"string"},initStyle:{type:Object,default:()=>({})},width:{type:String,default:"100px"},invisible:{type:Boolean,default:!1},readonly:{type:Boolean,default:null},textTransform:{type:String,default:null},textAlign:{type:String,default:null},keyField:{type:Boolean,default:!1},sticky:{type:Boolean,default:!1},validate:{type:Function,default:null},change:{type:Function,default:null},link:{type:Function,default:null},autoFillWidth:{type:Boolean,default:!1},allowKeys:{type:[Array,Function],default:()=>null},mandatory:{type:String,default:""},lengthLimit:{type:Number,default:0},autocomplete:{type:Boolean,default:null},pos:{type:Number,default:0},options:{type:[Array,Object,Function],default:()=>null},summary:{type:String,default:null},sort:{type:Function,default:null},toValue:{type:Function,default(e){switch(this.textTransform){case"uppercase":e=e.toUpperCase();break;case"lowercase":e=e.toLowerCase()}switch(this.type){case"datetick":case"datetimetick":case"datetimesectick":return new Date(e+" GMT+0").getTime();case"check10":case"checkYN":case"checkTF":return e.toUpperCase();case"map":if(this.options.constructor.name.endsWith("Function")){const t=this.options(e);return Object.keys(t).find((i=>t[i]===e))}return Object.keys(this.options).find((t=>this.options[t]===e));default:return e}}},toText:{type:Function,default(e){if(this.keyField&&e&&e.toString().startsWith("§"))return"";const t=60*(new Date).getTimezoneOffset()*1e3;let i;switch(this.type){case"date":return i=new Date(e).getTime(),i?new Date(i-t).toISOString().slice(0,10):"";case"datetick":return i=new Date(1*e?1*e:e).getTime(),i?new Date(i-t).toISOString().slice(0,10):"";case"datetimetick":return i=new Date(1*e?1*e:e).getTime(),i?new Date(i-t).toISOString().replace("T"," ").slice(0,16):"";case"datetimesectick":return i=new Date(1*e?1*e:e).getTime(),i?new Date(i-t).toISOString().replace("T"," ").slice(0,19):"";case"map":return this.options.constructor.name.endsWith("Function")?this.options(e)[e]:this.options[e];default:return e}}},register:{type:Function,default:null}},created(){this.init()},methods:{init(){const e=this;let t=this.initStyle,i=this.validate,s=this.allowKeys,l=this.lengthLimit;switch(this.type){case"number":t.textAlign="right",s=s||["0","1","2","3","4","5","6","7","8","9",".","-"];break;case"date":s=s||["0","1","2","3","4","5","6","7","8","9","-"];break;case"datetime":case"datetimesec":case"datetick":case"datetimetick":case"datetimesectick":s=s||["0","1","2","3","4","5","6","7","8","9","-"," ",":"];break;case"check10":t.textAlign="center",t.textTransform="uppercase",s=s||["0","1"],l=l||1;break;case"checkYN":t.textAlign="center",t.textTransform="uppercase",s=s||["Y","N"],l=l||1;break;case"checkTF":t.textAlign="center",t.textTransform="uppercase",s=s||["T","F"],l=l||1;break;case"map":if("AsyncFunction"===this.options.constructor.name)throw new Error("VueExcelColumn: Map does not support Async Function");break;case"select":case"string":break;default:throw new Error("VueExcelColumn: Not supported type:"+this.type)}this.textTransform&&(t.textTransform=this.textTransform),this.textAlign&&(t.textAlign=this.textAlign),this._autocomplete=e.autocomplete,this._readonly=e.readonly,this.$parent.registerColumn({name:this.field,label:null===this.label?this.field:this.label,type:this.type,width:this.width,autoFillWidth:this.autoFillWidth,validate:i,change:this.change,link:this.link,sort:this.sort,keyField:this.keyField,sticky:this.sticky,allowKeys:s,mandatory:this.mandatory,lengthLimit:Number(l),textTransform:this.textTransform,get autocomplete(){return"map"===e.type||"select"===e.type||(null===e._autocomplete?e.$parent.autocomplete:e._autocomplete)},set autocomplete(t){e._autocomplete=t},initStyle:t,invisible:this.invisible,get readonly(){return null===e._readonly?e.$parent.readonly:e._readonly},set readonly(t){e._readonly=t},pos:Number(this.pos),options:this.options,summary:this.summary,toValue:this.toValue,toText:this.toText,register:this.register})}}},[["render",function(i,s,l,o,n,r){return e(),t("div")}]]),Ht={install(e){e.component("vue-excel-editor",Rt),e.component("vue-excel-column",Dt)}};export{Ht as V,E as _};
